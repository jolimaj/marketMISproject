import{c as A,o as u,w as y,a as t,b as a,f as d,t as g,n as x,l as K,d as b,e as p,F as Q,r as W,E as J,g as R,x as G,G as X,S as Y}from"./app-uXddmEpz.js";import{f as N,i as H,b as B}from"./helper-BoB9zCoy.js";import{A as Z}from"./AppLayout-Br8Pf_X-.js";import{T as $}from"./TextInput-CHlK30DQ.js";import{L as ee}from"./LoadingButton-BLKfR7Zt.js";import{I as te}from"./InputLabel-D_8-PT0K.js";import{I as le}from"./InputError-ttZ3AOSc.js";import{S as re}from"./SelectInput-7AHhNMzI.js";import{P as se,S as ae,D as oe}from"./PaymentSummaryCard-7Fm_be5d.js";import{D as ne}from"./DatePick-bkgg8O9e.js";import{M as ie}from"./Map-CTiJm-EB.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Logo-C5gnPx-H.js";import"./Icons-C3pYYq2K.js";import"./Footer-Xx_KaGDa.js";import"./v4-C6aID195.js";const me={__name:"Form",props:{stallTypes:Object,stallRental:Object,requirements:Object,paymentDetails:Object},setup(T,{expose:l}){var S,k,h,I,D,q,V;l();const c=J(),e=R([]),m=R(1),E=R(null),s=T,i=()=>H(c.url),n=G({business_name:i()?(S=s==null?void 0:s.stallRental)==null?void 0:S.name:"",stall_id:i()?(h=(k=s==null?void 0:s.stallRental)==null?void 0:k.stalls)==null?void 0:h.id:"",started_date:i()?N((I=s==null?void 0:s.stallRental)==null?void 0:I.start_date):"",end_date:i()?N((D=s==null?void 0:s.stallRental)==null?void 0:D.end_date):"",requirements:[],receipt:null,reference_number:i()?(V=(q=s==null?void 0:s.stallRental)==null?void 0:q.paymentRecord)==null?void 0:V.reference_number:"",amount:0,step:m}),_=()=>{var r,L;n.requirements=i()?(r=s==null?void 0:s.volanteRental)==null?void 0:r.requirements.map(f=>({requirement_checklist_id:f.checklist_id,attachment:f.attachment})):e.value.map(f=>({requirement_checklist_id:f.documentType,attachment:f.file})),n.amount=(L=s==null?void 0:s.paymentDetails)==null?void 0:L.total,n.post(route("applications.stalls.store"),{onSuccess:()=>{n.reset(),e.value=[]}})},v=()=>{var r;n.put(route("applications.stalls.update",(r=s==null?void 0:s.stallRental)==null?void 0:r.id),{onSuccess:()=>{n.reset(),e.value=[]}})},w={page:c,localFiles:e,step:m,selectedStall:E,props:s,checkIfEdit:i,form:n,submit:_,update:v,stores:()=>i()?v():_(),feeDetails:r=>r!=null&&r.is_monthly?`${B(r.amount)} per month`:r!=null&&r.is_daily?`${B(r.amount)} per day`:`${B(r.amount)}`,nextButton:()=>{m.value===1?(console.log(i()),i()?m.value++:n.post(route("applications.stalls.store"),{preserveState:!0,onSuccess:()=>{m.value++}})):m.value===2&&(i()?m.value++:e.value.some(r=>r.status==="uploading")?n.errors.requirements="Please wait until all files are uploaded.":e.value.some(r=>r.status==="uploading")?n.errors.requirements="The requirements are required.":m.value++),n.step=m.value},onStallSelect:r=>{console.log("Selected Stall:",r),E.value=r,n.stall_id=r==null?void 0:r.id},computed:X,ref:R,get Link(){return Y},get usePage(){return J},get useForm(){return G},get formatAmount(){return B},get formatDateShort(){return N},get isEditPage(){return H},AppLayout:Z,TextInput:$,LoadingButton:ee,InputLabel:te,InputError:le,SelectInput:re,DocumentUpload:oe,SingleFileUpload:ae,PaymentSummaryCard:se,DatePick:ne,Map:ie};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}},ue={class:"mb-8 text-3xl font-bold"},ce={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},fe={class:"max-w-3xl bg-white rounded-md shadow overflow-hidden"},ge={class:"flex items-center px-8 py-4 bg-primary/20 border-t bg-primary/20"},xe={class:"flex items-center justify-between mt-6"},be={class:"flex flex-col items-center text-center w-1/3"},pe={class:"flex flex-col items-center text-center w-1/3"},ye={class:"flex flex-col items-center text-center w-1/3"},_e={key:0,class:"p-6 space-y-6"},ve={class:"flex flex-col md:flex-row gap-4 px-5"},we={class:"w-full md:w-full"},Se={class:"flex flex-col md:flex-row gap-4 px-5"},ke={key:0,class:"flex flex-col md:flex-row gap-4 px-5"},he={class:"w-full md:w-full"},Ie={class:"border p-4 rounded bg-gray-50"},De={class:"ml-4 list-disc"},qe={class:"mt-4 flex flex-col md:flex-row gap-4 px-5"},Ve={class:"w-full md:w-full"},Le={class:"w-full md:w-full"},Re={key:1,class:"p-6 space-y-6"},Be={key:2,class:"p-6 space-y-6"},Ee={class:"flex flex-col md:flex-row gap-4 mt-5"},je={class:"w-full"},Ce={class:"flex flex-col md:flex-row gap-4 mt-5"},Pe={class:"w-full"},Fe={class:"w-full"},Ne={class:"flex items-center px-8 py-4 bg-gray-50 border-t border-gray-100"},Te={class:"ml-auto flex gap-2"},Me=["disabled"];function Ue(T,l,c,e,m,E){return u(),A(e.AppLayout,{title:"Stall Types"},{header:y(()=>l[7]||(l[7]=[t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Stall Types ",-1)])),default:y(()=>{var s,i,n,_,v,j,C,P,F,w,S,k,h,I,D,q,V,r,L,f,M,U,z,O;return[t("h1",ue,[a(e.Link,{class:"text-primary hover:text-secondary",href:"/my-applications/stall-rental-permits"},{default:y(()=>l[8]||(l[8]=[d("Stall Rentals")])),_:1,__:[8]}),l[9]||(l[9]=t("span",{class:"text-secondary font-medium"},"/",-1)),d(" "+g(e.checkIfEdit()?`${(i=(s=e.props)==null?void 0:s.stallRental)==null?void 0:i.name}`:"Create New"),1)]),t("div",ce,[t("div",fe,[t("div",ge,[a(e.LoadingButton,{loading:e.form.processing,class:"bg-btn-gradient ml-auto",type:"submit",disabled:((n=c.stallRental)==null?void 0:n.status)!==1},{default:y(()=>l[10]||(l[10]=[d(" Renew ")])),_:1,__:[10]},8,["loading","disabled"])]),t("div",xe,[t("div",be,[t("div",{class:x(["flex items-center justify-center w-12 h-12 rounded-full border-2",e.step===1?"bg-primary text-white border-primary":"border-gray-300 text-gray-400"])},l[11]||(l[11]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5.121 17.804A7.968 7.968 0 0112 15c1.933 0 3.683.69 5.121 1.804M15 11a3 3 0 11-6 0 3 3 0 016 0z"})],-1)]),2),t("span",{class:x(["mt-2 text-sm",e.step===1?"text-primary font-semibold":"text-gray-400"])},"Business Info",2)]),t("div",{class:x(["flex-1 border-t-2 mx-2",e.step>1?"border-primary":"border-gray-200"])},null,2),t("div",pe,[t("div",{class:x(["flex items-center justify-center w-12 h-12 rounded-full border-2",e.step===2?"bg-primary text-white border-primary":"border-gray-300 text-gray-400"])},l[12]||(l[12]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 7h10M7 11h10M7 15h6M5 5v14h14V5H5z"})],-1)]),2),t("span",{class:x(["mt-2 text-sm",e.step===2?"text-primary font-semibold":"text-gray-400"])},"Requirements",2)]),t("div",{class:x(["flex-1 border-t-2 mx-2",e.step>2?"border-primary":"border-gray-200"])},null,2),t("div",ye,[t("div",{class:x(["flex items-center justify-center w-12 h-12 rounded-full border-2",e.step===3?"bg-primary text-white border-primary":"border-gray-300 text-gray-400"])},l[13]||(l[13]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 1.343-3 3h6c0-1.657-1.343-3-3-3zm9 3c0 4.418-4.03 8-9 8s-9-3.582-9-8V7h18v4z"})],-1)]),2),t("span",{class:x(["mt-2 text-sm",e.step===3?"text-primary font-semibold":"text-gray-400"])},"Payment",2)])]),t("form",{onSubmit:K(e.stores,["prevent"])},[e.step===1?(u(),b("div",_e,[t("div",ve,[t("div",we,[a(e.InputLabel,{for:"Business Name",value:"Business Name"}),a(e.TextInput,{id:"business_name",modelValue:e.form.business_name,"onUpdate:modelValue":l[0]||(l[0]=o=>e.form.business_name=o),type:"text",class:"mt-1 block w-full",required:"",autofocus:"",autocomplete:"business_name"},null,8,["modelValue"]),a(e.InputError,{class:"mt-2",message:(v=(_=e.form)==null?void 0:_.errors)==null?void 0:v.business_name},null,8,["message"])])]),t("div",Se,[a(e.Map,{datas:c.stallTypes,onSelect:e.onStallSelect,disabled:e.checkIfEdit()},null,8,["datas","disabled"]),a(e.InputError,{class:"mt-2",message:(C=(j=e.form)==null?void 0:j.errors)==null?void 0:C.stall_id},null,8,["message"])]),e.selectedStall?(u(),b("div",ke,[t("div",he,[t("div",Ie,[l[19]||(l[19]=t("h2",{class:"text-lg font-bold mb-2 text-secondary"},"Transient Details",-1)),t("p",null,[l[14]||(l[14]=t("strong",null,"Name:",-1)),d(" "+g((P=e.selectedStall)==null?void 0:P.name),1)]),t("p",null,[l[15]||(l[15]=t("strong",null,"Size:",-1)),d(" "+g((F=e.selectedStall)==null?void 0:F.area_of_sqr_meter),1)]),t("p",null,[l[16]||(l[16]=t("strong",null,"Coordinates:",-1)),d(" "+g(e.selectedStall?`Longitude-${JSON.parse((w=e.selectedStall)==null?void 0:w.size).long}, Latitude-${JSON.parse((S=e.selectedStall)==null?void 0:S.size).lat}`:""),1)]),t("p",null,[l[17]||(l[17]=t("strong",null,"Category:",-1)),d(" "+g((k=e.selectedStall)==null?void 0:k.categories.name),1)]),t("p",null,[l[18]||(l[18]=t("strong",null,"Description:",-1)),d(" "+g((h=e.selectedStall)==null?void 0:h.categories.description),1)]),l[20]||(l[20]=t("h3",{class:"mt-2 font-semibold text-secondary"},"Fees:",-1)),t("ul",De,[(u(!0),b(Q,null,W((D=(I=e.selectedStall)==null?void 0:I.categories)==null?void 0:D.fee,o=>(u(),b("li",{key:o.id},[t("strong",null,g(o.type)+":",1),d(" "+g(e.feeDetails(o)),1)]))),128))])])])])):p("",!0),t("div",qe,[t("div",Ve,[a(e.InputLabel,{for:"started_date",value:"Start Date"}),a(e.DatePick,{id:"started_date",modelValue:e.form.started_date,"onUpdate:modelValue":l[1]||(l[1]=o=>e.form.started_date=o),class:"mt-1 block w-full",required:"",autofocus:"",autocomplete:"started_date"},null,8,["modelValue"]),a(e.InputError,{class:"mt-2",message:e.form.errors.started_date},null,8,["message"])]),t("div",Le,[a(e.InputLabel,{for:"end_date",value:"End Date"}),a(e.DatePick,{id:"end_date",modelValue:e.form.end_date,"onUpdate:modelValue":l[2]||(l[2]=o=>e.form.end_date=o),class:"mt-1 block w-full",required:"",autofocus:"",autocomplete:"end_date"},null,8,["modelValue"]),a(e.InputError,{class:"mt-2",message:e.form.errors.end_date},null,8,["message"])])])])):p("",!0),e.step===2?(u(),b("div",Re,[a(e.DocumentUpload,{requiredDocs:e.checkIfEdit()?(q=c.requirements)==null?void 0:q.stall_new:(V=c.requirements)==null?void 0:V.stall_renew,files:e.localFiles,"onUpdate:files":l[3]||(l[3]=o=>e.localFiles=o)},null,8,["requiredDocs","files"]),a(e.InputError,{class:"mt-2",message:e.form.errors.requirements},null,8,["message"])])):p("",!0),e.step===3?(u(),b("div",Be,[l[21]||(l[21]=t("h2",{class:"text-lg font-bold text-secondary mb-2"},"Payments",-1)),l[22]||(l[22]=t("p",{class:"text-gray-600"},"Please complete your payment below:",-1)),l[23]||(l[23]=t("iframe",{src:"https://www.lbp-eservices.com/egps/portal/Fields.jsp",class:"w-full h-96 border rounded-md"},null,-1)),t("div",Ee,[t("div",je,[a(e.PaymentSummaryCard,{details:e.step===3?c.paymentDetails:null},null,8,["details"])])]),t("div",Ce,[t("div",Pe,[a(e.InputLabel,{for:"reference_number",value:"Reference Number"}),a(e.TextInput,{id:"reference_number",modelValue:e.form.reference_number,"onUpdate:modelValue":l[4]||(l[4]=o=>e.form.reference_number=o),type:"text",class:"mt-1 block w-full",required:"",autofocus:"",autocomplete:"reference_number"},null,8,["modelValue"]),a(e.InputError,{class:"mt-2",message:(L=(r=e.form)==null?void 0:r.errors)==null?void 0:L.reference_number},null,8,["message"])]),t("div",Fe,[a(e.InputLabel,{for:"receipt",value:"Receipt",class:"mb-1 block w-full"}),a(e.SingleFileUpload,{modelValue:e.form.receipt,"onUpdate:modelValue":l[5]||(l[5]=o=>e.form.receipt=o),label:"Upload Official Receipt",accept:".jpg,.jpeg,.png,.pdf",class:"mt-1 block w-full",error:(M=(f=e.form)==null?void 0:f.errors)==null?void 0:M.receipt},null,8,["modelValue","error"]),a(e.InputError,{class:"mt-2",message:(z=(U=e.form)==null?void 0:U.errors)==null?void 0:z.receipt},null,8,["message"])])])])):p("",!0),t("div",Ne,[a(e.Link,{href:"/my-applications/stall-rental-permits",class:"text-red-600 hover:underline",tabindex:"-1"},{default:y(()=>l[24]||(l[24]=[d("Cancel")])),_:1,__:[24]}),t("div",Te,[e.step>1?(u(),b("button",{key:0,type:"button",class:"px-4 py-2 rounded-md bg-gray-200 hover:bg-gray-300",onClick:l[6]||(l[6]=o=>e.step--)}," Back ")):p("",!0),e.step<3?(u(),b("button",{key:1,type:"button",class:"px-4 py-2 rounded-md bg-primary text-white hover:bg-secondary",disabled:((O=c.stallRental)==null?void 0:O.status)===1,onClick:e.nextButton}," Next ",8,Me)):p("",!0),e.step===3?(u(),A(e.LoadingButton,{key:2,loading:e.form.processing,class:"bg-primary ml-auto",type:"submit"},{default:y(()=>l[25]||(l[25]=[d(" Save ")])),_:1,__:[25]},8,["loading"])):p("",!0)])])],32)])])]}),_:1})}const rt=de(me,[["render",Ue],["__file","Form.vue"]]);export{rt as default};
