import{c as ue,o as c,w as x,a as e,b as l,k as le,d as u,F as S,r as A,t as a,v as fe,e as R,f as g,l as ne,m as pe,g as M,h as ie,x as de,i as ce,Q as me}from"./app-uXddmEpz.js";import{l as I,p as xe}from"./pickBy-Cz0_Eu6Y.js";import{A as ye}from"./AppLayout-Br8Pf_X-.js";import{B as _e}from"./BaseTable-BlSLnjYp.js";import{P as ge}from"./Pagination-CeXYWUig.js";import{S as ve}from"./SearchFilter-mzsd348G.js";import{B as we}from"./Badge-DyQTjnI6.js";import{f as he,a as be,b as ke}from"./helper-BoB9zCoy.js";import{I as De}from"./Icons-C3pYYq2K.js";import{D as Ce}from"./Drawer-DnP5ELEB.js";import{C as je}from"./ConfirmationModal-BIt7Xf-P.js";import{S as ze}from"./SecondaryButton-CtFZuys_.js";import{D as Ve}from"./DangerButton-CQleH8u-.js";import{I as Be}from"./InputError-ttZ3AOSc.js";import{_ as Se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Logo-C5gnPx-H.js";import"./Footer-Xx_KaGDa.js";import"./Modal-uTiD3aIt.js";const Ae={__name:"VolanteRental",props:{stallsCategories:Object,volanteRentals:Object,filters:Object,user:Object},setup(L,{expose:t}){var C,j;t();const y=["Permit No.","Business Name","Transient/Tent","Location","Duration","Area of Square Meter","Category","Applicant","Duration Period","Status"],s=M(!1),p=M({}),z=M(!1),V=[{id:1,name:"Daily "},{id:2,name:"Weekly "},{id:3,name:"Event-based"}],f=L,r=ie({search:(C=f==null?void 0:f.filters)==null?void 0:C.search,category:(j=f==null?void 0:f.filters)==null?void 0:j.category}),d=de({remarks:""});ce(r,I.throttle(()=>{me.get("/admin/applications/volantes",xe(r),{preserveState:!0})},150),{deep:!0});function o(){r.search="",r.category=null,Object.assign(r,I.mapValues(r,()=>null))}function k(n){let m="";return n===1?m="Daily":n===2?m="Weekly":m="Event based",m}function _(n){p.value=n,s.value=!0}const D={headers:y,showDrawer:s,drawerData:p,isRejected:z,durationsOptions:V,props:f,forms:r,form:d,reset:o,duration:k,getDetails:_,status:n=>{console.log(n);let m={color:"blue",status:"Pending"};switch(n){case 3:m={color:"orange",status:"Expired"};break;case 2:m={color:"red",status:"Rejected"};break;case 1:m={color:"green",status:"Approved"};break}return m},closeRejection:()=>{z.value=!1},rejectPermits:()=>{z.value=!0},approveConfirm:()=>{var n;delete d.remarks,d.put(route("department.applications.volantes.approve",(n=p==null?void 0:p.value)==null?void 0:n.id))},rejectConfirm:()=>{var n;delete d.remarks,d.put(route("department.applications.volantes.reject",(n=p==null?void 0:p.value)==null?void 0:n.id))},watch:ce,reactive:ie,ref:M,get useForm(){return de},get router(){return me},get throttle(){return I.throttle},get mapValues(){return I.mapValues},get pickBy(){return xe},AppLayout:ye,BaseTable:_e,Pagination:ge,SearchFilter:ve,Badge:we,get formatAmount(){return ke},get formatDate(){return be},get formatDateShort(){return he},Icons:De,Drawer:Ce,ConfirmationModal:je,SecondaryButton:ze,DangerButton:Ve,InputError:Be};return Object.defineProperty(D,"__isScriptSetup",{enumerable:!1,value:!0}),D}},Re={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Me={class:"flex items-center justify-between mb-6"},Ie=["value"],Le={class:"px-4 py-3 capitalize"},Ne={class:"px-4 py-3 capitalize"},Pe={class:"px-4 py-3 capitalize"},qe={class:"px-4 py-3 capitalize"},Oe={class:"px-4 py-3 capitalize"},Ee={class:"px-4 py-3 capitalize"},He={class:"px-4 py-3 capitalize"},Te={class:"px-4 py-3 capitalize"},Fe={class:"px-4 py-3 capitalize"},Ue={class:"px-4 py-3 capitalize"},We={class:"w-px border-t mr-5"},Je={key:0},Qe={class:"mt-6 flex justify-center"},Ge={key:0},Ke={class:"ml-auto w-full max-w-xl bg-white shadow-lg h-full overflow-y-auto"},Xe={class:"p-4 border rounded-xl mb-4 bg-gray-50 flex justify-between items-center"},Ye={class:"flex items-center space-x-3"},Ze={class:"font-semibold text-primary"},$e={class:"flex items-center text-xs text-gray-500 space-x-2"},et={key:0,class:"flex space-x-2"},tt={class:"p-4 border rounded-xl mb-5"},st={class:"space-y-2 text-sm"},at={class:"flex items-center space-x-2"},rt={class:"text-gray-600"},ot={class:"flex items-center space-x-2"},lt={class:"text-gray-600"},nt={class:"flex items-center space-x-2"},it={class:"text-gray-600"},dt={class:"flex items-center space-x-2"},ct={class:"text-gray-600"},mt={class:"flex items-center space-x-2"},xt={class:"text-gray-600"},ut={class:"p-4 border rounded-xl mb-5"},ft={class:"space-y-2 text-sm"},pt={class:"flex items-center space-x-2"},yt={class:"text-gray-600"},_t={class:"flex items-center space-x-2"},gt={class:"text-gray-600"},vt={class:"flex items-center space-x-2"},wt={class:"text-gray-600"},ht={class:"flex items-center space-x-2"},bt={class:"text-gray-600"},kt={class:"flex items-center space-x-2"},Dt={class:"text-gray-600"},Ct={class:"flex items-center space-x-2"},jt={class:"text-gray-600"},zt={class:"flex items-center space-x-2"},Vt={class:"text-gray-600"},Bt={class:"p-4 border rounded-xl mb-5"},St={class:"space-y-2"},At={class:"flex items-center space-x-2"},Rt={class:"text-gray-600"},Mt={class:"flex items-center px-2 py-1 text-blue-600 hover:text-blue-800 text-sm"},It=["href"],Lt={class:"p-4 border rounded-xl"},Nt={class:"space-y-2 text-sm"},Pt={class:"flex items-center space-x-2"},qt={class:"text-gray-600"},Ot={class:"flex items-center space-x-2"},Et={class:"text-gray-600"},Ht={class:"flex items-center space-x-2"},Tt={class:"space-y-2"},Ft={class:"flex items-center space-x-2"},Ut={class:"text-secondary"},Wt={class:"text-gray-600"},Jt={class:"flex items-center space-x-2"},Qt={class:"text-gray-600"},Gt={class:"space-y-4 p-4"},Kt={class:"flex justify-end space-x-3 p-4"};function Xt(L,t,y,s,p,z){return c(),ue(s.AppLayout,{title:"Volante"},{header:x(()=>t[4]||(t[4]=[e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Volante ",-1)])),default:x(()=>{var V,f;return[t[39]||(t[39]=e("h1",{class:"mb-8 text-3xl font-bold text-primary"},"Volante",-1)),e("div",Re,[e("div",Me,[l(s.SearchFilter,{modelValue:s.forms.search,"onUpdate:modelValue":t[1]||(t[1]=r=>s.forms.search=r),class:"mr-4 w-full max-w-md",onReset:s.reset},{default:x(()=>[t[6]||(t[6]=e("label",{class:"block text-gray-700"},"Stall Category:",-1)),le(e("select",{"onUpdate:modelValue":t[0]||(t[0]=r=>s.forms.category=r),class:"form-select mt-1 w-full"},[t[5]||(t[5]=e("option",{value:null},"All",-1)),(c(!0),u(S,null,A(y.stallsCategories,r=>(c(),u("option",{key:r.id,value:r.id},a(r.name),9,Ie))),128))],512),[[fe,s.forms.category]])]),_:1,__:[6]},8,["modelValue"])]),l(s.BaseTable,{headers:s.headers,data:(V=y.volanteRentals)==null?void 0:V.data},{row:x(({data:r})=>{var d;return[(c(!0),u(S,null,A(r,(o,k)=>{var _,v,w,h;return c(),u("tr",{key:y.volanteRentals.id,class:"hover:bg-gray-50"},[e("td",Le,a(((_=o==null?void 0:o.permits)==null?void 0:_.permit_number)??"-"),1),e("td",Ne,a(o.name),1),e("td",Pe,a((v=o.stalls)==null?void 0:v.name),1),e("td",qe,a(o.location),1),e("td",Oe,a(s.duration(o==null?void 0:o.duration)),1),e("td",Ee,a((w=o.stalls)==null?void 0:w.area_of_sqr_meter),1),e("td",He,a((h=o.stalls)==null?void 0:h.stallsCategories.name),1),e("td",Te,a(`${o.user.first_name} ${o.user.first_name}`),1),e("td",Fe,a(`${s.formatDate(o.start_date)} - ${s.formatDate(o.end_date)}`),1),e("td",Ue,[l(s.Badge,{color:s.status(o.permits.status).color},{default:x(()=>[g(a(s.status(o.permits.status).status),1)]),_:2},1032,["color"])]),e("td",We,[l(s.Icons,{name:"cheveron-right",onClick:B=>s.getDetails(o),class:"block w-6 h-6 fill-primary"},null,8,["onClick"])])])}),128)),((d=y.volanteRentals)==null?void 0:d.total)===0?(c(),u("tr",Je,t[7]||(t[7]=[e("td",{class:"px-6 py-4 border-t text-center",colspan:"7"},"No records found.",-1)]))):R("",!0)]}),_:1},8,["data"])]),e("div",Qe,[l(s.Pagination,{links:(f=y.volanteRentals)==null?void 0:f.links},null,8,["links"])]),l(s.Drawer,{modelValue:s.showDrawer,"onUpdate:modelValue":t[2]||(t[2]=r=>s.showDrawer=r),title:"Application Details",data:s.drawerData.value},{default:x(()=>{var r,d,o,k,_,v,w,h,B,N,D,C,j,n,m,P,q,O,E,H,T,F,U,W,J,Q,G,K,X,Y,Z,$,ee,te,se,ae,re,oe;return[s.drawerData?(c(),u("div",Ge,[e("div",Ke,[e("div",Xe,[e("div",Ye,[l(s.Icons,{name:"stalls",class:"block w-6 h-6 fill-primary"}),e("div",null,[e("p",Ze,a(`Volante Rental Application (${(d=(r=s.drawerData)==null?void 0:r.permits)==null?void 0:d.type})`),1),e("div",$e,[l(s.Badge,{color:s.status((o=s.drawerData)==null?void 0:o.permits.status).color},{default:x(()=>{var i;return[g(a(s.status((i=s.drawerData)==null?void 0:i.permits.status).status),1)]}),_:1},8,["color"]),e("span",null,a(`â€¢ Applied ${s.formatDateShort(s.drawerData.permits.created_at)}`),1)])])]),((k=L.$page.props.auth.user)==null?void 0:k.role_id)===2?(c(),u("div",et,[e("button",{class:"flex items-center px-3 py-1.5 text-white bg-red-600 rounded-lg hover:bg-red-700 text-sm",onClick:s.rejectPermits},t[8]||(t[8]=[e("svg",{class:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:`M4.293 4.293a1 1 0 
                            011.414 0L10 8.586l4.293-4.293a1 1 0 
                            111.414 1.414L11.414 10l4.293 4.293a1 1 
                            01-1.414 1.414L10 11.414l-4.293 4.293a1 
                            1 0 01-1.414-1.414L8.586 10 4.293 
                            5.707a1 1 0 010-1.414z`,"clip-rule":"evenodd"})],-1),g(" Reject ")])),e("form",{onSubmit:ne(s.approveConfirm,["prevent"])},t[9]||(t[9]=[e("button",{class:"flex items-center px-3 py-1.5 text-white bg-green-600 rounded-lg hover:bg-green-700 text-sm"},[e("svg",{class:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:`M16.707 5.293a1 1 0 
                                010 1.414l-8 8a1 1 0 
                                01-1.414 0l-4-4a1 1 0 
                                011.414-1.414L8 12.586l7.293-7.293a1 1 
                                0 011.414 0z`,"clip-rule":"evenodd"})]),g(" Approve ")],-1)]),32)])):R("",!0)]),e("div",tt,[t[20]||(t[20]=e("h3",{class:"text-md font-semibold mb-3 text-primary"},"Applicant Information",-1)),e("ul",st,[e("li",at,[t[11]||(t[11]=e("svg",{class:"w-4 h-4 text-secondary",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:`M10 2a5 5 0 100 
                                10 5 5 0 000-10zM2 18a8 8 0 
                                1116 0H2z`,"clip-rule":"evenodd"})],-1)),e("span",null,[t[10]||(t[10]=e("strong",{class:"text-secondary"},"Full Name: ",-1)),e("span",rt,a(`${(v=(_=s.drawerData)==null?void 0:_.user)==null?void 0:v.first_name} ${(h=(w=s.drawerData)==null?void 0:w.user)==null?void 0:h.last_name}`),1)])]),e("li",ot,[t[13]||(t[13]=e("svg",{class:"w-4 h-4 text-secondary",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:`M2.94 6.34A2 2 0 
                                014 6h12a2 2 0 
                                011.06.34L10 11 2.94 6.34z`}),e("path",{d:`M18 8l-8 5-8-5v6a2 2 0 
                                002 2h12a2 2 0 002-2V8z`})],-1)),e("span",null,[t[12]||(t[12]=e("strong",{class:"text-secondary"},"Email Address: ",-1)),e("span",lt,a((N=(B=s.drawerData)==null?void 0:B.user)==null?void 0:N.email),1)])]),e("li",nt,[t[15]||(t[15]=e("svg",{class:"w-4 h-4 text-secondary",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:`M2 3a1 1 0 
                                011-1h2a1 1 0 011 1v2a1 1 0 
                                01-1 1H4v2.586a1 1 0 
                                01-.293.707l-.707.707a1 1 0 
                                000 1.414l3 3a1 1 0 
                                001.414 0l.707-.707A1 1 0 
                                019 12.586V10h2a1 1 0 
                                011 1v2a1 1 0 01-1 1H9.414a1 1 
                                0 00-.707.293l-2 2A1 1 0 
                                006 17.414V18a1 1 0 01-1 1H3a1 
                                1 0 01-1-1V3z`})],-1)),e("span",null,[t[14]||(t[14]=e("strong",{class:"text-secondary"},"Phone Number: ",-1)),e("span",it,a((C=(D=s.drawerData)==null?void 0:D.user)==null?void 0:C.mobile),1)])]),e("li",dt,[t[17]||(t[17]=e("svg",{class:"w-4 h-4 text-secondary",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:`M10 2a6 6 0 
                                00-6 6c0 4.418 6 10 6 10s6-5.582 
                                6-10a6 6 0 00-6-6zm0 8a2 2 0 
                                110-4 2 2 0 010 4z`,"clip-rule":"evenodd"})],-1)),e("span",null,[t[16]||(t[16]=e("strong",{class:"text-secondary"},"Address: ",-1)),e("span",ct,a((n=(j=s.drawerData)==null?void 0:j.user)==null?void 0:n.address),1)])]),e("li",mt,[t[19]||(t[19]=e("svg",{class:"w-4 h-4 text-secondary",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:`M10 2a1 1 0 00-1 1v1a1 1 0 
                                    002 0V3a1 1 0 00-1-1zM6 5a2 2 0 
                                    114 0v1H6V5zm6 0a2 2 0 114 0v1h-4V5zM4 
                                    9a2 2 0 012-2h8a2 2 0 012 2v2H4V9zm-1 
                                    4h14a1 1 0 011 1v2a2 2 0 
                                    01-2 2H5a2 2 0 
                                    01-2-2v-2a1 1 0 
                                    011-1z`})],-1)),e("span",null,[t[18]||(t[18]=e("strong",{class:"text-secondary"},"Birthday: ",-1)),e("span",xt,a(s.formatDateShort((P=(m=s.drawerData)==null?void 0:m.user)==null?void 0:P.birthday)),1)])])])]),e("div",ut,[t[29]||(t[29]=e("h3",{class:"text-md font-semibold mb-3 text-primary"},"Business Information",-1)),e("ul",ft,[e("li",pt,[l(s.Icons,{name:"business-names",class:"block w-6 h-6 fill-secondary"}),e("span",null,[t[21]||(t[21]=e("strong",{class:"text-secondary"},"Business Name: ",-1)),e("span",yt,a((q=s.drawerData)==null?void 0:q.name),1)])]),e("li",_t,[l(s.Icons,{name:"stall-names",class:"block w-6 h-6 fill-secondary"}),e("span",null,[t[22]||(t[22]=e("strong",{class:"text-secondary"},"Stall Name: ",-1)),e("span",gt,a((E=(O=s.drawerData)==null?void 0:O.stalls)==null?void 0:E.name),1)])]),e("li",vt,[l(s.Icons,{name:"business-category",class:"block w-6 h-6 fill-secondary"}),e("span",null,[t[23]||(t[23]=e("strong",{class:"text-secondary"},"Category: ",-1)),e("span",wt,a((F=(T=(H=s.drawerData)==null?void 0:H.stalls)==null?void 0:T.stallsCategories)==null?void 0:F.name),1)])]),e("li",ht,[t[25]||(t[25]=e("svg",{class:"w-4 h-4 text-secondary",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:`M10 2a6 6 0 
                                00-6 6c0 4.418 6 10 6 10s6-5.582 
                                6-10a6 6 0 00-6-6zm0 8a2 2 0 
                                110-4 2 2 0 010 4z`,"clip-rule":"evenodd"})],-1)),e("span",null,[t[24]||(t[24]=e("strong",{class:"text-secondary"},"Stall Location ",-1)),e("span",bt,a((U=s.drawerData)==null?void 0:U.location),1)])]),e("li",kt,[l(s.Icons,{name:"business-size",class:"block w-6 h-6 fill-secondary"}),e("span",null,[t[26]||(t[26]=e("strong",{class:"text-secondary"},"Size: ",-1)),e("span",Dt,a(`Longitude: ${(J=JSON.parse((W=s.drawerData.stalls)==null?void 0:W.size))==null?void 0:J.long}, Latitude: ${(G=JSON.parse((Q=s.drawerData.stalls)==null?void 0:Q.size))==null?void 0:G.lat}`),1)])]),e("li",Ct,[l(s.Icons,{name:"business-area",class:"block w-6 h-6 fill-secondary"}),e("span",null,[t[27]||(t[27]=e("strong",{class:"text-secondary"},"Area of Square Meter: ",-1)),e("span",jt,a((X=(K=s.drawerData)==null?void 0:K.stalls)==null?void 0:X.area_of_sqr_meter),1)])]),e("li",zt,[l(s.Icons,{name:"business-area",class:"block w-6 h-6 fill-secondary"}),e("span",null,[t[28]||(t[28]=e("strong",{class:"text-secondary"},"Duration: ",-1)),e("span",Vt,a((Y=s.durationsOptions)==null?void 0:Y.find(i=>{var b;return i.id===((b=s.drawerData)==null?void 0:b.duration)})),1)])])])]),e("div",Bt,[t[30]||(t[30]=e("h3",{class:"text-md font-semibold mb-3 text-primary"},"Requirements Submitted",-1)),e("ul",St,[(c(!0),u(S,null,A(s.drawerData.requirements,(i,b)=>(c(),u("li",{key:b,class:"flex justify-between items-center bg-gray-50 px-3 py-2 rounded-lg shadow-sm"},[e("div",At,[l(s.Icons,{name:"requirements",class:"block w-6 h-6 fill-primary"}),e("span",Rt,a(i.name),1)]),e("button",Mt,[i.url?(c(),u("a",{key:0,href:`${i.url}/${i.attachment}`,class:"text-blue-600 ml-2 hover:underline",target:"_blank"}," [View] ",8,It)):R("",!0)])]))),128))])]),e("div",Lt,[t[34]||(t[34]=e("h3",{class:"text-md font-semibold mb-3 text-primary"},"Payments",-1)),e("ul",Nt,[e("li",Pt,[e("span",null,[t[31]||(t[31]=e("strong",{class:"text-secondary"},"Days: ",-1)),e("span",qt,a(`${($=(Z=s.drawerData)==null?void 0:Z.payments)==null?void 0:$.days}`),1)])]),e("li",Ot,[e("span",null,[t[32]||(t[32]=e("strong",{class:"text-secondary"},"Weeks: ",-1)),e("span",Et,a(`${(te=(ee=s.drawerData)==null?void 0:ee.payments)==null?void 0:te.weeks}`),1)])]),e("li",Ht,[e("ul",Tt,[(c(!0),u(S,null,A((ae=(se=s.drawerData)==null?void 0:se.payments)==null?void 0:ae.breakdown,(i,b)=>(c(),u("li",{key:b,class:"flex justify-between items-center bg-gray-50 px-3 py-2 rounded-lg shadow-sm"},[e("div",Ft,[e("span",null,[e("strong",Ut,a(`â€¢ ${i==null?void 0:i.type}: `),1),e("span",Wt,a(s.formatAmount(i==null?void 0:i.amount)),1)])])]))),128))])]),e("li",Jt,[e("span",null,[t[33]||(t[33]=e("strong",{class:"text-secondary"},"Total: ",-1)),e("span",Qt,a(s.formatAmount((oe=(re=s.drawerData)==null?void 0:re.payments)==null?void 0:oe.total)),1)])])])])])])):R("",!0)]}),_:1},8,["modelValue","data"]),l(s.ConfirmationModal,{show:s.isRejected,onClose:s.closeRejection},{title:x(()=>t[35]||(t[35]=[g(" Reject Request ")])),content:x(()=>{var r,d;return[e("div",Gt,[t[36]||(t[36]=e("p",{class:"text-gray-700 text-sm md:text-base"}," Are you sure you would like to reject this request? Please provide a reason below: ",-1)),e("div",null,[le(e("textarea",{id:"remarks","onUpdate:modelValue":t[3]||(t[3]=o=>s.form.remarks=o),rows:"3",required:"",placeholder:"Enter your reason for rejection...",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500 sm:text-sm resize-none"},null,512),[[pe,s.form.remarks]]),l(s.InputError,{class:"mt-2",message:(d=(r=s.form)==null?void 0:r.errors)==null?void 0:d.remarks},null,8,["message"])])])]}),footer:x(()=>[e("div",Kt,[l(s.SecondaryButton,{onClick:s.closeRejection},{default:x(()=>t[37]||(t[37]=[g(" Cancel ")])),_:1,__:[37]}),e("form",{onSubmit:ne(s.rejectConfirm,["prevent"])},[l(s.DangerButton,{disabled:!s.form.remarks,class:"disabled:opacity-50"},{default:x(()=>t[38]||(t[38]=[g(" Reject ")])),_:1,__:[38]},8,["disabled"])],32)])]),_:1},8,["show"])]}),_:1,__:[39]})}const ps=Se(Ae,[["render",Xt],["__file","VolanteRental.vue"]]);export{ps as default};
