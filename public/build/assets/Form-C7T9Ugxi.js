import{d,e as b,o,a as l,p as J,F as P,r as U,t as f,I as T,f as c,c as Q,w as x,b as s,n as v,l as Y,E as W,g as A,x as G,S as Z}from"./app-BkL1CNwx.js";import{c as C,a as M,i as K}from"./helper-Jpd2WSUx.js";import{A as $}from"./AppLayout-BPPdX9d-.js";import{T as ee}from"./TextInput-duXXTKs6.js";import{L as te}from"./LoadingButton-BKJNCDXS.js";import{I as le}from"./InputLabel-C9urSnAe.js";import{I as re}from"./InputError-DDM46-4k.js";import{S as se}from"./SelectInput-CcVjRgud.js";import{D as oe}from"./DocumentUpload-ClAk4XTQ.js";import{D as ae}from"./DatePick-CmOi26Oi.js";import{S as ne}from"./SingleFileUpload-Bwb2u20k.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Logo-DeUXyAzp.js";import"./Icons-DwfuqtxP.js";import"./Footer-DHOCUsg6.js";import"./v4-C6aID195.js";const ie={__name:"PaymentSummaryCard",props:{details:{type:Object,required:!0}},setup(g,{expose:t}){t();const m=g,e=T(()=>{const{breakdown:n,total:y,...i}=m.details;return i}),a={props:m,filteredDetails:e,computed:T,get formatAmount(){return C}};return Object.defineProperty(a,"__isScriptSetup",{enumerable:!1,value:!0}),a}},de={key:0,class:"max-w-md mx-auto"},me={class:"bg-white rounded-2xl shadow p-6 space-y-4"},ue={class:"text-lg font-semibold text-gray-800 flex items-center"},fe={class:"capitalize"},ce={class:"font-medium text-gray-800"},ye={key:0,class:"border-t pt-3"},be={class:"space-y-1"},ge={class:"font-medium"},xe={key:1,class:"border-t pt-3 flex justify-between items-center"},ve={class:"text-xl font-bold text-primary"};function _e(g,t,m,e,a,n){return m.details?(o(),d("div",de,[l("div",me,[l("h2",ue,[J(g.$slots,"icon",{},()=>[t[0]||(t[0]=l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5 mr-2 text-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.1 0-2 .9-2 2v2h4v-2c0-1.1-.9-2-2-2zm-6 8V10a6 6 0 1112 0v6h2v2H4v-2h2z"})],-1))]),J(g.$slots,"title",{},()=>[t[1]||(t[1]=c("Payment Summary",-1))])]),(o(!0),d(P,null,U(e.filteredDetails,(y,i)=>(o(),d("div",{key:i,class:"flex justify-between text-sm text-gray-600"},[l("span",fe,f(i),1),l("span",ce,f(y),1)]))),128)),m.details.breakdown?(o(),d("div",ye,[t[2]||(t[2]=l("h3",{class:"text-sm font-semibold text-gray-700 mb-2"},"Breakdown",-1)),l("ul",be,[(o(!0),d(P,null,U(m.details.breakdown,(y,i)=>(o(),d("li",{key:i,class:"flex justify-between text-sm"},[l("span",null,f(y.type||`Item ${i+1}`),1),l("span",ge,f(e.formatAmount(y.amount)),1)]))),128))])])):b("",!0),m.details.total!==void 0?(o(),d("div",xe,[t[3]||(t[3]=l("span",{class:"text-base font-semibold text-gray-700"},"Total",-1)),l("span",ve,f(e.formatAmount(m.details.total)),1)])):b("",!0)])])):b("",!0)}const pe=X(ie,[["render",_e],["__file","PaymentSummaryCard.vue"]]),we={__name:"Form",props:{volanteRental:Object,stallTypes:Object,requirements:Object,paymentDetails:Object,total_payments:Object},setup(g,{expose:t}){var h,S,q,I,V,D,j,E,L,R;t();const m=W(),e=g,a=A(1),n=()=>K(m.url),y=[{id:1,name:"Daily "},{id:2,name:"Weekly "},{id:3,name:"Event-based"}],i=A([]),u=G({business_name:n()?(h=e==null?void 0:e.volanteRental)==null?void 0:h.name:"",location:n()?(S=e==null?void 0:e.volanteRental)==null?void 0:S.location:"",duration:n()?(q=e==null?void 0:e.volanteRental)==null?void 0:q.duration:[],started_date:n()?M((I=e==null?void 0:e.volanteRental)==null?void 0:I.start_date):"",end_date:n()?M((V=e==null?void 0:e.volanteRental)==null?void 0:V.end_date):"",stall_id:n()?(j=(D=e==null?void 0:e.volanteRental)==null?void 0:D.stalls)==null?void 0:j.id:"",quantity:n()?(E=e==null?void 0:e.volanteRental)==null?void 0:E.quantity:"",requirements:[],receipt:null,reference_number:n()?(R=(L=e==null?void 0:e.volanteRental)==null?void 0:L.paymentRecord)==null?void 0:R.reference_number:"",amount:0,step:a}),_=T(()=>{var r;return(r=e==null?void 0:e.stallTypes)==null?void 0:r.find(O=>O.id===Number(u.stall_id))}),p=()=>{var r,O,H;u.requirements=n()?(r=e==null?void 0:e.volanteRental)==null?void 0:r.requirements.map(B=>({requirement_checklist_id:B.checklist_id,attachment:B.attachment})):i.value.map(B=>({requirement_checklist_id:B.documentType,attachment:B.file})),u.amount=(O=e==null?void 0:e.paymentDetails)==null?void 0:O.total,u.location=(H=_==null?void 0:_.value)==null?void 0:H.location,u.post(route("applications.volantes.store"),{onSuccess:()=>{u.reset(),i.value=[]}})},w=()=>{var r;u.put(route("applications.volantes.update",(r=e==null?void 0:e.volanteRental)==null?void 0:r.id))},k={page:m,props:e,step:a,checkIfEdit:n,durationsOptions:y,localFiles:i,form:u,selectedStall:_,submit:p,update:w,nextButton:()=>{a.value===1?(console.log(n()),n()?a.value++:u.post(route("applications.volantes.store"),{preserveState:!0,onSuccess:()=>{a.value++}})):a.value===2?n()?a.value++:i.value.some(r=>r.status==="uploading")?u.errors.requirements="Please wait until all files are uploaded.":i.value.length===0?u.errors.requirements="The requirements are required.":a.value++:a.value===3&&(n()?a.value++:i.value.some(r=>r.status==="uploading")?u.errors.requirements="Please wait until all files are uploaded.":i.value.length===0?u.errors.requirements="The requirements are required.":a.value++),u.step=a.value},stores:()=>{if(a.value===3)return n()?w():p()},feeDetails:r=>r!=null&&r.is_monthly?`${C(r.amount)} per month`:r!=null&&r.is_daily?`${C(r.amount)} per day`:`${C(r.amount)}`,computed:T,ref:A,get Link(){return Z},get usePage(){return W},get useForm(){return G},get formatAmount(){return C},get formatDateShort(){return M},get isEditPage(){return K},AppLayout:$,TextInput:ee,LoadingButton:te,InputLabel:le,InputError:re,SelectInput:se,DocumentUpload:oe,DatePick:ae,SingleFileUpload:ne,PaymentSummaryCard:pe};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}},ke={class:"mb-8 text-3xl font-bold"},he={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Se={class:"max-w-3xl bg-white rounded-md shadow overflow-hidden"},qe={class:"flex items-center px-8 py-4 bg-primary/20 border-t bg-primary/20"},Ie={class:"flex items-center justify-between mt-6"},Ve={class:"flex flex-col items-center text-center w-1/3"},De={class:"flex flex-col items-center text-center w-1/3"},je={class:"flex flex-col items-center text-center w-1/3"},Ee={key:0,class:"p-6 space-y-6"},Le={class:"flex flex-col md:flex-row gap-4"},Re={class:"w-full"},Be={class:"w-full"},Ce=["value","disabled"],Pe={key:0,class:"border p-4 rounded bg-gray-50"},Ue={class:"ml-4 list-disc"},Oe={class:"flex flex-col md:flex-row gap-4"},Te={class:"w-full md:w-full"},Fe={class:"w-full md:w-full"},Ne=["value"],ze={class:"mt-4 flex flex-col md:flex-row gap-4"},Ae={class:"w-full md:w-full"},Me={class:"w-full md:w-full"},He={key:1,class:"p-6 space-y-6"},Je={key:2,class:"p-6 space-y-6"},Qe={class:"flex flex-col md:flex-row gap-4 mt-5"},We={class:"w-full"},Ge={class:"flex flex-col md:flex-row gap-4 mt-5"},Ke={class:"w-full"},Xe={class:"w-full"},Ye={class:"flex items-center px-8 py-4 bg-gray-50 border-t border-gray-100"},Ze={class:"ml-auto flex gap-2"},$e=["disable"];function et(g,t,m,e,a,n){return o(),Q(e.AppLayout,{title:"Volante"},{header:x(()=>[...t[10]||(t[10]=[l("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Volante",-1)])]),default:x(()=>{var y,i,u,_,p,w,F,N,z,k,h,S,q,I,V,D,j,E,L,R;return[l("h1",ke,[s(e.Link,{class:"text-primary hover:text-secondary",href:"/my-applications/volante-rental-permits"},{default:x(()=>[...t[11]||(t[11]=[c("Volante Rentals",-1)])]),_:1}),t[12]||(t[12]=l("span",{class:"text-secondary font-medium"},"/",-1)),c(" "+f(e.checkIfEdit()?`${(i=(y=e.props)==null?void 0:y.volanteRental)==null?void 0:i.name}`:"Create New"),1)]),l("div",he,[l("div",Se,[l("div",qe,[s(e.LoadingButton,{loading:e.form.processing,class:"bg-btn-gradient ml-auto",type:"submit",disabled:((u=g.stallRental)==null?void 0:u.status)!==1},{default:x(()=>[...t[13]||(t[13]=[c(" Renew ",-1)])]),_:1},8,["loading","disabled"])]),l("div",Ie,[l("div",Ve,[l("div",{class:v(["flex items-center justify-center w-12 h-12 rounded-full border-2",e.step===1?"bg-primary text-white border-primary":"border-gray-300 text-gray-400"])},[...t[14]||(t[14]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5.121 17.804A7.968 7.968 0 0112 15c1.933 0 3.683.69 5.121 1.804M15 11a3 3 0 11-6 0 3 3 0 016 0z"})],-1)])],2),l("span",{class:v(["mt-2 text-sm",e.step===1?"text-primary font-semibold":"text-gray-400"])},"Business Info",2)]),l("div",{class:v(["flex-1 border-t-2 mx-2",e.step>1?"border-primary":"border-gray-200"])},null,2),l("div",De,[l("div",{class:v(["flex items-center justify-center w-12 h-12 rounded-full border-2",e.step===2?"bg-primary text-white border-primary":"border-gray-300 text-gray-400"])},[...t[15]||(t[15]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 7h10M7 11h10M7 15h6M5 5v14h14V5H5z"})],-1)])],2),l("span",{class:v(["mt-2 text-sm",e.step===2?"text-primary font-semibold":"text-gray-400"])},"Requirements",2)]),l("div",{class:v(["flex-1 border-t-2 mx-2",e.step>2?"border-primary":"border-gray-200"])},null,2),l("div",je,[l("div",{class:v(["flex items-center justify-center w-12 h-12 rounded-full border-2",e.step===3?"bg-primary text-white border-primary":"border-gray-300 text-gray-400"])},[...t[16]||(t[16]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 1.343-3 3h6c0-1.657-1.343-3-3-3zm9 3c0 4.418-4.03 8-9 8s-9-3.582-9-8V7h18v4z"})],-1)])],2),l("span",{class:v(["mt-2 text-sm",e.step===3?"text-primary font-semibold":"text-gray-400"])},"Payment",2)])]),l("form",{onSubmit:Y(e.stores,["prevent"])},[e.step===1?(o(),d("div",Ee,[l("div",Le,[l("div",Re,[s(e.InputLabel,{for:"Business Name",value:"Business Name"}),s(e.TextInput,{id:"business_name",modelValue:e.form.business_name,"onUpdate:modelValue":t[0]||(t[0]=r=>e.form.business_name=r),type:"text",class:"mt-1 block w-full",required:"",autofocus:"",autocomplete:"business_name"},null,8,["modelValue"]),s(e.InputError,{class:"mt-2",message:(p=(_=e.form)==null?void 0:_.errors)==null?void 0:p.business_name},null,8,["message"])]),l("div",Be,[s(e.InputLabel,{for:"stall_id",value:"Stall",class:"mb-1 block w-full"}),s(e.SelectInput,{modelValue:e.form.stall_id,"onUpdate:modelValue":t[1]||(t[1]=r=>e.form.stall_id=r),id:"stall_id",required:"",class:"w-full",autocomplete:"stall_id",disabled:e.checkIfEdit()},{default:x(()=>[(o(!0),d(P,null,U(m.stallTypes,r=>(o(),d("option",{key:r.id,value:r.id,disabled:r.status===1||r.status===3},f(r.status===1||r.status===3?`${r.name} (${r.categories.description}) - OCCUPIED`:`${r.name} (${r.categories.description})`),9,Ce))),128))]),_:1},8,["modelValue","disabled"]),s(e.InputError,{class:"mt-2",message:(F=(w=e.form)==null?void 0:w.errors)==null?void 0:F.stall_id},null,8,["message"])])]),e.selectedStall?(o(),d("div",Pe,[t[22]||(t[22]=l("h2",{class:"text-lg font-bold mb-2 text-secondary"},"Transient Details",-1)),l("p",null,[t[17]||(t[17]=l("strong",null,"Name:",-1)),c(" "+f(e.selectedStall.name),1)]),l("p",null,[t[18]||(t[18]=l("strong",null,"Size:",-1)),c(" "+f(e.selectedStall.area_of_sqr_meter),1)]),l("p",null,[t[19]||(t[19]=l("strong",null,"Coordinates:",-1)),c(" "+f(`Longitude-${JSON.parse(e.selectedStall.size).long}, Latitude-${JSON.parse(e.selectedStall.size).lat}`),1)]),l("p",null,[t[20]||(t[20]=l("strong",null,"Category:",-1)),c(" "+f(e.selectedStall.categories.name),1)]),l("p",null,[t[21]||(t[21]=l("strong",null,"Description:",-1)),c(" "+f(e.selectedStall.categories.description),1)]),t[23]||(t[23]=l("h3",{class:"mt-2 font-semibold text-secondary"},"Fees:",-1)),l("ul",Ue,[(o(!0),d(P,null,U(e.selectedStall.categories.fee,r=>(o(),d("li",{key:r.id},[l("strong",null,f(r.type)+":",1),c(" "+f(e.feeDetails(r)),1)]))),128))])])):b("",!0),l("div",Oe,[l("div",Te,[s(e.InputLabel,{for:"Quantity",value:"Quantity(kilo or styro)"}),s(e.TextInput,{id:"quantity",modelValue:e.form.quantity,"onUpdate:modelValue":t[2]||(t[2]=r=>e.form.quantity=r),type:"number",class:"mt-1 block w-full",required:"",autofocus:"",autocomplete:"quantity"},null,8,["modelValue"]),s(e.InputError,{class:"mt-2",message:(z=(N=e.form)==null?void 0:N.errors)==null?void 0:z.quantity},null,8,["message"])]),l("div",Fe,[s(e.InputLabel,{for:"duration",value:"Duration",class:"mb-1 block w-full"}),s(e.SelectInput,{modelValue:e.form.duration,"onUpdate:modelValue":t[3]||(t[3]=r=>e.form.duration=r),id:"duration",required:"",class:"w-full",autocomplete:"duration"},{default:x(()=>[(o(),d(P,null,U(e.durationsOptions,r=>l("option",{key:r.id,value:r.id},f(r.name),9,Ne)),64))]),_:1},8,["modelValue"]),s(e.InputError,{class:"mt-2",message:(h=(k=e.form)==null?void 0:k.errors)==null?void 0:h.duration},null,8,["message"])])]),l("div",ze,[l("div",Ae,[s(e.InputLabel,{for:"started_date",value:"Start Date"}),s(e.DatePick,{id:"started_date",modelValue:e.form.started_date,"onUpdate:modelValue":t[4]||(t[4]=r=>e.form.started_date=r),class:"mt-1 block w-full",required:"",autofocus:"",autocomplete:"started_date"},null,8,["modelValue"]),s(e.InputError,{class:"mt-2",message:e.form.errors.started_date},null,8,["message"])]),l("div",Me,[s(e.InputLabel,{for:"end_date",value:"End Date"}),s(e.DatePick,{id:"end_date",modelValue:e.form.end_date,"onUpdate:modelValue":t[5]||(t[5]=r=>e.form.end_date=r),class:"mt-1 block w-full",required:"",autofocus:"",autocomplete:"end_date"},null,8,["modelValue"]),s(e.InputError,{class:"mt-2",message:e.form.errors.end_date},null,8,["message"])])])])):b("",!0),e.step===2?(o(),d("div",He,[s(e.DocumentUpload,{requiredDocs:e.checkIfEdit()?(S=m.requirements)==null?void 0:S.volante_new:(q=m.requirements)==null?void 0:q.volante_renew,files:e.localFiles,"onUpdate:files":t[6]||(t[6]=r=>e.localFiles=r)},null,8,["requiredDocs","files"]),s(e.InputError,{class:"mt-2",message:e.form.errors.requirements},null,8,["message"])])):b("",!0),e.step===3?(o(),d("div",Je,[t[24]||(t[24]=l("h2",{class:"text-lg font-bold text-secondary mb-2"},"Payments",-1)),t[25]||(t[25]=l("p",{class:"text-gray-600"},"Please complete your payment below:",-1)),t[26]||(t[26]=l("iframe",{src:"https://www.lbp-eservices.com/egps/portal/Fields.jsp",class:"w-full h-96 border rounded-md"},null,-1)),l("div",Qe,[l("div",We,[s(e.PaymentSummaryCard,{details:e.step===3?m.paymentDetails:null},null,8,["details"])])]),l("div",Ge,[l("div",Ke,[s(e.InputLabel,{for:"reference_number",value:"Reference Number"}),s(e.TextInput,{id:"reference_number",modelValue:e.form.reference_number,"onUpdate:modelValue":t[7]||(t[7]=r=>e.form.reference_number=r),type:"text",class:"mt-1 block w-full",required:"",autofocus:"",autocomplete:"reference_number"},null,8,["modelValue"]),s(e.InputError,{class:"mt-2",message:(V=(I=e.form)==null?void 0:I.errors)==null?void 0:V.reference_number},null,8,["message"])]),l("div",Xe,[s(e.InputLabel,{for:"receipt",value:"Receipt",class:"mb-1 block w-full"}),s(e.SingleFileUpload,{modelValue:e.form.receipt,"onUpdate:modelValue":t[8]||(t[8]=r=>e.form.receipt=r),label:"Upload Official Receipt",accept:".jpg,.jpeg,.png,.pdf",class:"mt-1 block w-full",error:(j=(D=e.form)==null?void 0:D.errors)==null?void 0:j.receipt},null,8,["modelValue","error"]),s(e.InputError,{class:"mt-2",message:(L=(E=e.form)==null?void 0:E.errors)==null?void 0:L.receipt},null,8,["message"])])])])):b("",!0),l("div",Ye,[s(e.Link,{href:"/my-rentals/market-volante",class:"text-red-600 hover:underline",tabindex:"-1"},{default:x(()=>[...t[27]||(t[27]=[c("Cancel",-1)])]),_:1}),l("div",Ze,[e.step>1?(o(),d("button",{key:0,type:"button",class:"px-4 py-2 rounded-md bg-gray-200 hover:bg-gray-300",onClick:t[9]||(t[9]=r=>e.step--)}," Back ")):b("",!0),e.step<3?(o(),d("button",{key:1,type:"button",class:"px-4 py-2 rounded-md bg-primary text-white hover:bg-secondary",onClick:e.nextButton,disable:((R=m.volanteRental)==null?void 0:R.status)===1}," Next ",8,$e)):b("",!0),e.step===3?(o(),Q(e.LoadingButton,{key:2,loading:e.form.processing,class:"bg-primary ml-auto",type:"submit"},{default:x(()=>[...t[28]||(t[28]=[c(" Save ",-1)])]),_:1},8,["loading"])):b("",!0)])])],32)])])]}),_:1})}const xt=X(we,[["render",et],["__file","Form.vue"]]);export{xt as default};
