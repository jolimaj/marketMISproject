import{j as fe,c as pe,o as d,w as m,a as e,b as o,k as ne,d as c,F as z,r as V,t as a,v as ye,e as S,f as v,l as ie,m as ge,g as A,h as de,x as ce,i as me,Q as ue}from"./app-uXddmEpz.js";import{f as _e,a as ve,b as we}from"./helper-BoB9zCoy.js";import{l as R,p as xe}from"./pickBy-Cz0_Eu6Y.js";import{A as he}from"./AppLayout-Br8Pf_X-.js";import{B as be}from"./BaseTable-BlSLnjYp.js";import{P as ke}from"./Pagination-CeXYWUig.js";import{S as De}from"./SearchFilter-mzsd348G.js";import{B as Se}from"./Badge-DyQTjnI6.js";import{I as je}from"./Icons-C3pYYq2K.js";import{D as Ce}from"./Drawer-DnP5ELEB.js";import{C as Be}from"./ConfirmationModal-BIt7Xf-P.js";import{D as ze}from"./DangerButton-CQleH8u-.js";import{S as Ve}from"./SecondaryButton-CtFZuys_.js";import{_ as Ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Logo-C5gnPx-H.js";import"./Footer-Xx_KaGDa.js";import"./Modal-uTiD3aIt.js";const Re={__name:"StallRental",props:{stallsCategories:Object,stallRentals:Object,filters:Object,auth:Object},setup(M,{expose:t}){var k,D;t();const _=["Applicants Name","Business Name","Stall Name","Duration Date","Status",""],s=A(!1),p=A({}),j=A(!1),u=M,x=de({search:(k=u==null?void 0:u.filters)==null?void 0:k.search,category:(D=u==null?void 0:u.filters)==null?void 0:D.category}),y=ce({remarks:""});me(x,R.throttle(()=>{var n;ue.get(((n=u.auth.user)==null?void 0:n.role_id)===1?"/admin/applications/stalls":"/department/applications/stall-rental-permits",xe(x),{preserveState:!0})},150),{deep:!0});function r(){x.search="",x.category=null,Object.assign(x,R.mapValues(x,()=>null))}function f(n){p.value=n,s.value=!0}const b={headers:_,showDrawer:s,drawerData:p,isRejected:j,props:u,form:x,forms:y,reset:r,getDetails:f,status:n=>{let g={color:"blue",status:"Vacant"};switch(n){case 3:g={color:"orange",status:"Expired"};break;case 2:g={color:"red",status:"Rejected"};break;case 1:g={color:"green",status:"Approved"};break;default:g={color:"blue",status:"Pending"}}return g},closeRejection:()=>{j.value=!1},rejectPermits:()=>{j.value=!0},approveConfirm:()=>{var n;delete y.remarks,y.put(route("department.applications.stalls.approve",(n=p==null?void 0:p.value)==null?void 0:n.id))},rejectConfirm:()=>{var n;delete y.remarks,y.put(route("department.applications.stalls.reject",(n=p==null?void 0:p.value)==null?void 0:n.id))},watch:me,reactive:de,ref:A,get formatAmount(){return we},get formatDate(){return ve},get formatDateShort(){return _e},get router(){return ue},get useForm(){return ce},get throttle(){return R.throttle},get mapValues(){return R.mapValues},get pickBy(){return xe},AppLayout:he,BaseTable:be,Pagination:ke,SearchFilter:De,Badge:Se,Icons:je,Drawer:Ce,ConfirmationModal:Be,DangerButton:ze,SecondaryButton:Ve};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}},Me={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Ie={class:"flex items-center justify-between mb-6"},Ne=["value"],Le={class:"px-4 py-3 capitalize"},Pe={class:"px-4 py-3 capitalize"},qe={class:"px-4 py-3 capitalize"},Oe={class:"px-4 py-3 capitalize"},Ee={class:"px-4 py-3 capitalize"},He={key:0,class:"w-px border-t"},Fe={key:0},Te={class:"mt-6 flex justify-center"},Ue={key:0},Je={class:"ml-auto w-full max-w-xl bg-white shadow-lg h-full overflow-y-auto"},Qe={class:"p-4 border rounded-xl mb-4 bg-gray-50 flex justify-between items-center"},Ge={class:"flex items-center space-x-3"},Ke={class:"font-semibold text-primary"},We={class:"flex items-center text-xs text-gray-500 space-x-2"},Xe={key:0,class:"flex space-x-2"},Ye={class:"p-4 border rounded-xl mb-5"},Ze={class:"space-y-2 text-sm"},$e={class:"flex items-center space-x-2"},et={class:"text-gray-600"},tt={class:"flex items-center space-x-2"},st={class:"text-gray-600"},at={class:"flex items-center space-x-2"},lt={class:"text-gray-600"},rt={class:"flex items-center space-x-2"},ot={class:"text-gray-600"},nt={class:"flex items-center space-x-2"},it={class:"text-gray-600"},dt={class:"p-4 border rounded-xl mb-5"},ct={class:"space-y-2 text-sm"},mt={class:"flex items-center space-x-2"},ut={class:"text-gray-600"},xt={class:"flex items-center space-x-2"},ft={class:"text-gray-600"},pt={class:"flex items-center space-x-2"},yt={class:"text-gray-600"},gt={class:"flex items-center space-x-2"},_t={class:"text-gray-600"},vt={class:"flex items-center space-x-2"},wt={class:"text-gray-600"},ht={class:"flex items-center space-x-2"},bt={class:"text-gray-600"},kt={class:"p-4 border rounded-xl mb-5"},Dt={class:"space-y-2"},St={class:"flex items-center space-x-2"},jt={class:"text-gray-600"},Ct={class:"flex items-center px-2 py-1 text-blue-600 hover:text-blue-800 text-sm"},Bt=["href"],zt={class:"p-4 border rounded-xl"},Vt={class:"space-y-2 text-sm"},At={class:"flex items-center space-x-2"},Rt={class:"text-gray-600"},Mt={class:"flex items-center space-x-2"},It={class:"text-gray-600"},Nt={class:"flex items-center space-x-2"},Lt={class:"space-y-2"},Pt={class:"flex items-center space-x-2"},qt={class:"text-secondary"},Ot={class:"text-gray-600"},Et={class:"flex items-center space-x-2"},Ht={class:"text-gray-600"},Ft={class:"space-y-4 p-4"},Tt={class:"flex justify-end space-x-3 p-4"};function Ut(M,t,_,s,p,j){const u=fe("InputError");return d(),pe(s.AppLayout,{title:"Stalls"},{header:m(()=>t[4]||(t[4]=[e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Stalls ",-1)])),default:m(()=>{var x,y;return[t[38]||(t[38]=e("h1",{class:"mb-8 text-3xl font-bold text-primary"},"Stalls",-1)),e("div",Me,[e("div",Ie,[o(s.SearchFilter,{modelValue:s.form.search,"onUpdate:modelValue":t[1]||(t[1]=r=>s.form.search=r),class:"mr-4 w-full max-w-md",onReset:s.reset},{default:m(()=>[t[6]||(t[6]=e("label",{class:"block text-gray-700"},"Stall Category:",-1)),ne(e("select",{"onUpdate:modelValue":t[0]||(t[0]=r=>s.form.category=r),class:"form-select mt-1 w-full"},[t[5]||(t[5]=e("option",{value:null},"All",-1)),(d(!0),c(z,null,V(_.stallsCategories,r=>(d(),c("option",{key:r.id,value:r.id},a(r.name),9,Ne))),128))],512),[[ye,s.form.category]])]),_:1,__:[6]},8,["modelValue"])]),o(s.BaseTable,{headers:s.headers,data:(x=_.stallRentals)==null?void 0:x.data},{row:m(({data:r})=>{var f;return[(d(!0),c(z,null,V(r,(l,C)=>{var w,h;return d(),c("tr",{key:_.stallRentals.id,class:"hover:bg-gray-50"},[e("td",Le,a(`${l.user.first_name} ${l.user.first_name}`),1),e("td",Pe,a(l.name),1),e("td",qe,a(l.stalls.name),1),e("td",Oe,a(l!=null&&l.start_date&&(l!=null&&l.end_date)?`${s.formatDate(l.start_date)} - ${s.formatDate(l.end_date)}`:"-"),1),e("td",Ee,[o(s.Badge,{color:s.status(l.permits.status).color},{default:m(()=>[v(a(s.status(l.permits.status).status),1)]),_:2},1032,["color"])]),((h=(w=s.props)==null?void 0:w.filters)==null?void 0:h.role)!=="user"?(d(),c("td",He,[o(s.Icons,{name:"cheveron-right",onClick:B=>s.getDetails(l),class:"block w-6 h-6 fill-primary"},null,8,["onClick"])])):S("",!0)])}),128)),((f=_.stallRentals)==null?void 0:f.total)===0?(d(),c("tr",Fe,t[7]||(t[7]=[e("td",{class:"px-6 py-4 border-t text-center",colspan:"7"},"No records found.",-1)]))):S("",!0)]}),_:1},8,["data"])]),e("div",Te,[o(s.Pagination,{links:(y=_.stallRentals)==null?void 0:y.links},null,8,["links"])]),o(s.Drawer,{modelValue:s.showDrawer,"onUpdate:modelValue":t[2]||(t[2]=r=>s.showDrawer=r),title:"Application Details",data:s.drawerData.value},{default:m(()=>{var r,f,l,C,w,h,B,b,k,D,n,g,N,L,P,q,O,E,H,F,T,U,J,Q,G,K,W,X,Y,Z,$,ee,te,se,ae,le,re,oe;return[s.drawerData?(d(),c("div",Ue,[e("div",Je,[e("div",Qe,[e("div",Ge,[o(s.Icons,{name:"stalls",class:"block w-6 h-6 fill-primary"}),e("div",null,[e("p",Ke,a(`Stall Rental Application (${(f=(r=s.drawerData)==null?void 0:r.permits)==null?void 0:f.type})`),1),e("div",We,[o(s.Badge,{color:s.status((l=s.drawerData)==null?void 0:l.permits.status).color},{default:m(()=>{var i;return[v(a(s.status((i=s.drawerData)==null?void 0:i.permits.status).status),1)]}),_:1},8,["color"]),e("span",null,a(`• Applied ${s.formatDateShort(s.drawerData.permits.created_at)}`),1)])])]),((C=M.$page.props.auth.user)==null?void 0:C.role_id)===2?(d(),c("div",Xe,[e("button",{class:"flex items-center px-3 py-1.5 text-white bg-red-600 rounded-lg hover:bg-red-700 text-sm",onClick:s.rejectPermits},t[8]||(t[8]=[e("svg",{class:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:`M4.293 4.293a1 1 0 
                            011.414 0L10 8.586l4.293-4.293a1 1 0 
                            111.414 1.414L11.414 10l4.293 4.293a1 1 
                            01-1.414 1.414L10 11.414l-4.293 4.293a1 
                            1 0 01-1.414-1.414L8.586 10 4.293 
                            5.707a1 1 0 010-1.414z`,"clip-rule":"evenodd"})],-1),v(" Reject ")])),e("form",{onSubmit:ie(s.approveConfirm,["prevent"])},t[9]||(t[9]=[e("button",{class:"flex items-center px-3 py-1.5 text-white bg-green-600 rounded-lg hover:bg-green-700 text-sm"},[e("svg",{class:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:`M16.707 5.293a1 1 0 
                                010 1.414l-8 8a1 1 0 
                                01-1.414 0l-4-4a1 1 0 
                                011.414-1.414L8 12.586l7.293-7.293a1 1 
                                0 011.414 0z`,"clip-rule":"evenodd"})]),v(" Approve ")],-1)]),32)])):S("",!0)]),e("div",Ye,[t[20]||(t[20]=e("h3",{class:"text-md font-semibold mb-3 text-primary"},"Applicant Information",-1)),e("ul",Ze,[e("li",$e,[t[11]||(t[11]=e("svg",{class:"w-4 h-4 text-secondary",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:`M10 2a5 5 0 100 
                                10 5 5 0 000-10zM2 18a8 8 0 
                                1116 0H2z`,"clip-rule":"evenodd"})],-1)),e("span",null,[t[10]||(t[10]=e("strong",{class:"text-secondary"},"Full Name: ",-1)),e("span",et,a(`${(h=(w=s.drawerData)==null?void 0:w.user)==null?void 0:h.first_name} ${(b=(B=s.drawerData)==null?void 0:B.user)==null?void 0:b.last_name}`),1)])]),e("li",tt,[t[13]||(t[13]=e("svg",{class:"w-4 h-4 text-secondary",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:`M2.94 6.34A2 2 0 
                                014 6h12a2 2 0 
                                011.06.34L10 11 2.94 6.34z`}),e("path",{d:`M18 8l-8 5-8-5v6a2 2 0 
                                002 2h12a2 2 0 002-2V8z`})],-1)),e("span",null,[t[12]||(t[12]=e("strong",{class:"text-secondary"},"Email Address: ",-1)),e("span",st,a((D=(k=s.drawerData)==null?void 0:k.user)==null?void 0:D.email),1)])]),e("li",at,[t[15]||(t[15]=e("svg",{class:"w-4 h-4 text-secondary",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:`M2 3a1 1 0 
                                011-1h2a1 1 0 011 1v2a1 1 0 
                                01-1 1H4v2.586a1 1 0 
                                01-.293.707l-.707.707a1 1 0 
                                000 1.414l3 3a1 1 0 
                                001.414 0l.707-.707A1 1 0 
                                019 12.586V10h2a1 1 0 
                                011 1v2a1 1 0 01-1 1H9.414a1 1 
                                0 00-.707.293l-2 2A1 1 0 
                                006 17.414V18a1 1 0 01-1 1H3a1 
                                1 0 01-1-1V3z`})],-1)),e("span",null,[t[14]||(t[14]=e("strong",{class:"text-secondary"},"Phone Number: ",-1)),e("span",lt,a((g=(n=s.drawerData)==null?void 0:n.user)==null?void 0:g.mobile),1)])]),e("li",rt,[t[17]||(t[17]=e("svg",{class:"w-4 h-4 text-secondary",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:`M10 2a6 6 0 
                                00-6 6c0 4.418 6 10 6 10s6-5.582 
                                6-10a6 6 0 00-6-6zm0 8a2 2 0 
                                110-4 2 2 0 010 4z`,"clip-rule":"evenodd"})],-1)),e("span",null,[t[16]||(t[16]=e("strong",{class:"text-secondary"},"Address: ",-1)),e("span",ot,a((L=(N=s.drawerData)==null?void 0:N.user)==null?void 0:L.address),1)])]),e("li",nt,[t[19]||(t[19]=e("svg",{class:"w-4 h-4 text-secondary",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:`M10 2a1 1 0 00-1 1v1a1 1 0 
                                    002 0V3a1 1 0 00-1-1zM6 5a2 2 0 
                                    114 0v1H6V5zm6 0a2 2 0 114 0v1h-4V5zM4 
                                    9a2 2 0 012-2h8a2 2 0 012 2v2H4V9zm-1 
                                    4h14a1 1 0 011 1v2a2 2 0 
                                    01-2 2H5a2 2 0 
                                    01-2-2v-2a1 1 0 
                                    011-1z`})],-1)),e("span",null,[t[18]||(t[18]=e("strong",{class:"text-secondary"},"Birthday: ",-1)),e("span",it,a(s.formatDateShort((q=(P=s.drawerData)==null?void 0:P.user)==null?void 0:q.birthday)),1)])])])]),e("div",dt,[t[28]||(t[28]=e("h3",{class:"text-md font-semibold mb-3 text-primary"},"Business Information",-1)),e("ul",ct,[e("li",mt,[o(s.Icons,{name:"business-names",class:"block w-6 h-6 fill-secondary"}),e("span",null,[t[21]||(t[21]=e("strong",{class:"text-secondary"},"Business Name: ",-1)),e("span",ut,a((O=s.drawerData)==null?void 0:O.name),1)])]),e("li",xt,[o(s.Icons,{name:"stall-names",class:"block w-6 h-6 fill-secondary"}),e("span",null,[t[22]||(t[22]=e("strong",{class:"text-secondary"},"Stall Name: ",-1)),e("span",ft,a((H=(E=s.drawerData)==null?void 0:E.stalls)==null?void 0:H.name),1)])]),e("li",pt,[o(s.Icons,{name:"business-category",class:"block w-6 h-6 fill-secondary"}),e("span",null,[t[23]||(t[23]=e("strong",{class:"text-secondary"},"Category: ",-1)),e("span",yt,a((U=(T=(F=s.drawerData)==null?void 0:F.stalls)==null?void 0:T.stallsCategories)==null?void 0:U.name),1)])]),e("li",gt,[t[25]||(t[25]=e("svg",{class:"w-4 h-4 text-secondary",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:`M10 2a6 6 0 
                                00-6 6c0 4.418 6 10 6 10s6-5.582 
                                6-10a6 6 0 00-6-6zm0 8a2 2 0 
                                110-4 2 2 0 010 4z`,"clip-rule":"evenodd"})],-1)),e("span",null,[t[24]||(t[24]=e("strong",{class:"text-secondary"},"Stall Location ",-1)),e("span",_t,a((Q=(J=s.drawerData)==null?void 0:J.stalls)==null?void 0:Q.location),1)])]),e("li",vt,[o(s.Icons,{name:"business-size",class:"block w-6 h-6 fill-secondary"}),e("span",null,[t[26]||(t[26]=e("strong",{class:"text-secondary"},"Size: ",-1)),e("span",wt,a(`Longitude: ${(K=JSON.parse((G=s.drawerData.stalls)==null?void 0:G.size))==null?void 0:K.long}, Latitude: ${(X=JSON.parse((W=s.drawerData.stalls)==null?void 0:W.size))==null?void 0:X.lat}`),1)])]),e("li",ht,[o(s.Icons,{name:"business-area",class:"block w-6 h-6 fill-secondary"}),e("span",null,[t[27]||(t[27]=e("strong",{class:"text-secondary"},"Area of Square Meter: ",-1)),e("span",bt,a((Z=(Y=s.drawerData)==null?void 0:Y.stalls)==null?void 0:Z.area_of_sqr_meter),1)])])])]),e("div",kt,[t[29]||(t[29]=e("h3",{class:"text-md font-semibold mb-3 text-primary"},"Requirements Submitted",-1)),e("ul",Dt,[(d(!0),c(z,null,V(s.drawerData.requirements,(i,I)=>(d(),c("li",{key:I,class:"flex justify-between items-center bg-gray-50 px-3 py-2 rounded-lg shadow-sm"},[e("div",St,[o(s.Icons,{name:"requirements",class:"block w-6 h-6 fill-primary"}),e("span",jt,a(i.name),1)]),e("button",Ct,[i.url?(d(),c("a",{key:0,href:`${i.url}/${i.attachment}`,class:"text-blue-600 ml-2 hover:underline",target:"_blank"}," [View] ",8,Bt)):S("",!0)])]))),128))])]),e("div",zt,[t[33]||(t[33]=e("h3",{class:"text-md font-semibold mb-3 text-primary"},"Payments",-1)),e("ul",Vt,[e("li",At,[e("span",null,[t[30]||(t[30]=e("strong",{class:"text-secondary"},"Days: ",-1)),e("span",Rt,a(`${(ee=($=s.drawerData)==null?void 0:$.payments)==null?void 0:ee.days}`),1)])]),e("li",Mt,[e("span",null,[t[31]||(t[31]=e("strong",{class:"text-secondary"},"Months: ",-1)),e("span",It,a(`${(se=(te=s.drawerData)==null?void 0:te.payments)==null?void 0:se.months}`),1)])]),e("li",Nt,[e("ul",Lt,[(d(!0),c(z,null,V((le=(ae=s.drawerData)==null?void 0:ae.payments)==null?void 0:le.breakdown,(i,I)=>(d(),c("li",{key:I,class:"flex justify-between items-center bg-gray-50 px-3 py-2 rounded-lg shadow-sm"},[e("div",Pt,[e("span",null,[e("strong",qt,a(`• ${i==null?void 0:i.type}: `),1),e("span",Ot,a(s.formatAmount(i==null?void 0:i.amount)),1)])])]))),128))])]),e("li",Et,[e("span",null,[t[32]||(t[32]=e("strong",{class:"text-secondary"},"Total: ",-1)),e("span",Ht,a(s.formatAmount((oe=(re=s.drawerData)==null?void 0:re.payments)==null?void 0:oe.total)),1)])])])])])])):S("",!0)]}),_:1},8,["modelValue","data"]),o(s.ConfirmationModal,{show:s.isRejected,onClose:s.closeRejection},{title:m(()=>t[34]||(t[34]=[v(" Reject Request ")])),content:m(()=>{var r,f;return[e("div",Ft,[t[35]||(t[35]=e("p",{class:"text-gray-700 text-sm md:text-base"}," Are you sure you would like to reject this request? Please provide a reason below: ",-1)),e("div",null,[ne(e("textarea",{id:"remarks","onUpdate:modelValue":t[3]||(t[3]=l=>s.form.remarks=l),rows:"3",required:"",placeholder:"Enter your reason for rejection...",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500 sm:text-sm resize-none"},null,512),[[ge,s.form.remarks]]),o(u,{class:"mt-2",message:(f=(r=s.form)==null?void 0:r.errors)==null?void 0:f.remarks},null,8,["message"])])])]}),footer:m(()=>[e("div",Tt,[o(s.SecondaryButton,{onClick:s.closeRejection},{default:m(()=>t[36]||(t[36]=[v(" Cancel ")])),_:1,__:[36]}),e("form",{onSubmit:ie(s.rejectConfirm,["prevent"])},[o(s.DangerButton,{disabled:!s.form.remarks,class:"disabled:opacity-50"},{default:m(()=>t[37]||(t[37]=[v(" Reject ")])),_:1,__:[37]},8,["disabled"])],32)])]),_:1},8,["show"])]}),_:1,__:[38]})}const is=Ae(Re,[["render",Ut],["__file","StallRental.vue"]]);export{is as default};
