import{d as l,o as a,b as s,e as u,w as t,f as i,n as y,a as r,F as b,r as P,t as k,x as A,g as T}from"./app-uXddmEpz.js";import{A as x}from"./ActionMessage-CCDD4Tq0.js";import{D as C,A as F}from"./DialogModal-CEquPEd4.js";import{C as S}from"./Checkbox-CfZlSIIb.js";import{C as B}from"./ConfirmationModal-BIt7Xf-P.js";import{D}from"./DangerButton-CQleH8u-.js";import{F as I}from"./FormSection-BcmzQ4al.js";import{I as w}from"./InputError-ttZ3AOSc.js";import{I as M}from"./InputLabel-D_8-PT0K.js";import{P as V}from"./PrimaryButton-Q75du8kc.js";import{S as L}from"./SecondaryButton-CtFZuys_.js";import{S as N}from"./SectionBorder-DunoIkQn.js";import{T as j}from"./TextInput-CHlK30DQ.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./SectionTitle-4XE_3y5m.js";import"./Modal-uTiD3aIt.js";const U={__name:"ApiTokenManager",props:{tokens:Array,availablePermissions:Array,defaultPermissions:Array},setup(p,{expose:e}){e();const m=p,o=A({name:"",permissions:m.defaultPermissions}),c=A({permissions:[]}),v=A({}),n=T(!1),d=T(null),g=T(null),_={props:m,createApiTokenForm:o,updateApiTokenForm:c,deleteApiTokenForm:v,displayingToken:n,managingPermissionsFor:d,apiTokenBeingDeleted:g,createApiToken:()=>{o.post(route("api-tokens.store"),{preserveScroll:!0,onSuccess:()=>{n.value=!0,o.reset()}})},manageApiTokenPermissions:f=>{c.permissions=f.abilities,d.value=f},updateApiToken:()=>{c.put(route("api-tokens.update",d.value),{preserveScroll:!0,preserveState:!0,onSuccess:()=>d.value=null})},confirmApiTokenDeletion:f=>{g.value=f},deleteApiToken:()=>{v.delete(route("api-tokens.destroy",g.value),{preserveScroll:!0,preserveState:!0,onSuccess:()=>g.value=null})},ref:T,get useForm(){return A},ActionMessage:x,ActionSection:F,Checkbox:S,ConfirmationModal:B,DangerButton:D,DialogModal:C,FormSection:I,InputError:w,InputLabel:M,PrimaryButton:V,SecondaryButton:L,SectionBorder:N,TextInput:j};return Object.defineProperty(_,"__isScriptSetup",{enumerable:!1,value:!0}),_}},z={class:"col-span-6 sm:col-span-4"},O={key:0,class:"col-span-6"},Y={class:"mt-2 grid grid-cols-1 md:grid-cols-2 gap-4"},q={class:"flex items-center"},G={class:"ms-2 text-sm text-gray-600"},H={key:0},J={class:"mt-10 sm:mt-0"},K={class:"space-y-6"},Q={class:"break-all"},R={class:"flex items-center ms-2"},W={key:0,class:"text-sm text-gray-400"},X=["onClick"],Z=["onClick"],h={key:0,class:"mt-4 bg-gray-100 px-4 py-2 rounded font-mono text-sm text-gray-500 break-all"},$={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ee={class:"flex items-center"},oe={class:"ms-2 text-sm text-gray-600"};function ne(p,e,m,o,c,v){return a(),l("div",null,[s(o.FormSection,{onSubmitted:o.createApiToken},{title:t(()=>e[9]||(e[9]=[i(" Create API Token ")])),description:t(()=>e[10]||(e[10]=[i(" API tokens allow third-party services to authenticate with our application on your behalf. ")])),form:t(()=>[r("div",z,[s(o.InputLabel,{for:"name",value:"Name"}),s(o.TextInput,{id:"name",modelValue:o.createApiTokenForm.name,"onUpdate:modelValue":e[0]||(e[0]=n=>o.createApiTokenForm.name=n),type:"text",class:"mt-1 block w-full",autofocus:""},null,8,["modelValue"]),s(o.InputError,{message:o.createApiTokenForm.errors.name,class:"mt-2"},null,8,["message"])]),m.availablePermissions.length>0?(a(),l("div",O,[s(o.InputLabel,{for:"permissions",value:"Permissions"}),r("div",Y,[(a(!0),l(b,null,P(m.availablePermissions,n=>(a(),l("div",{key:n},[r("label",q,[s(o.Checkbox,{checked:o.createApiTokenForm.permissions,"onUpdate:checked":e[1]||(e[1]=d=>o.createApiTokenForm.permissions=d),value:n},null,8,["checked","value"]),r("span",G,k(n),1)])]))),128))])])):u("",!0)]),actions:t(()=>[s(o.ActionMessage,{on:o.createApiTokenForm.recentlySuccessful,class:"me-3"},{default:t(()=>e[11]||(e[11]=[i(" Created. ")])),_:1,__:[11]},8,["on"]),s(o.PrimaryButton,{class:y({"opacity-25":o.createApiTokenForm.processing}),disabled:o.createApiTokenForm.processing},{default:t(()=>e[12]||(e[12]=[i(" Create ")])),_:1,__:[12]},8,["class","disabled"])]),_:1}),m.tokens.length>0?(a(),l("div",H,[s(o.SectionBorder),r("div",J,[s(o.ActionSection,null,{title:t(()=>e[13]||(e[13]=[i(" Manage API Tokens ")])),description:t(()=>e[14]||(e[14]=[i(" You may delete any of your existing tokens if they are no longer needed. ")])),content:t(()=>[r("div",K,[(a(!0),l(b,null,P(m.tokens,n=>(a(),l("div",{key:n.id,class:"flex items-center justify-between"},[r("div",Q,k(n.name),1),r("div",R,[n.last_used_ago?(a(),l("div",W," Last used "+k(n.last_used_ago),1)):u("",!0),m.availablePermissions.length>0?(a(),l("button",{key:1,class:"cursor-pointer ms-6 text-sm text-gray-400 underline",onClick:d=>o.manageApiTokenPermissions(n)}," Permissions ",8,X)):u("",!0),r("button",{class:"cursor-pointer ms-6 text-sm text-red-500",onClick:d=>o.confirmApiTokenDeletion(n)}," Delete ",8,Z)])]))),128))])]),_:1})])])):u("",!0),s(o.DialogModal,{show:o.displayingToken,onClose:e[3]||(e[3]=n=>o.displayingToken=!1)},{title:t(()=>e[15]||(e[15]=[i(" API Token ")])),content:t(()=>[e[16]||(e[16]=r("div",null," Please copy your new API token. For your security, it won't be shown again. ",-1)),p.$page.props.jetstream.flash.token?(a(),l("div",h,k(p.$page.props.jetstream.flash.token),1)):u("",!0)]),footer:t(()=>[s(o.SecondaryButton,{onClick:e[2]||(e[2]=n=>o.displayingToken=!1)},{default:t(()=>e[17]||(e[17]=[i(" Close ")])),_:1,__:[17]})]),_:1},8,["show"]),s(o.DialogModal,{show:o.managingPermissionsFor!=null,onClose:e[6]||(e[6]=n=>o.managingPermissionsFor=null)},{title:t(()=>e[18]||(e[18]=[i(" API Token Permissions ")])),content:t(()=>[r("div",$,[(a(!0),l(b,null,P(m.availablePermissions,n=>(a(),l("div",{key:n},[r("label",ee,[s(o.Checkbox,{checked:o.updateApiTokenForm.permissions,"onUpdate:checked":e[4]||(e[4]=d=>o.updateApiTokenForm.permissions=d),value:n},null,8,["checked","value"]),r("span",oe,k(n),1)])]))),128))])]),footer:t(()=>[s(o.SecondaryButton,{onClick:e[5]||(e[5]=n=>o.managingPermissionsFor=null)},{default:t(()=>e[19]||(e[19]=[i(" Cancel ")])),_:1,__:[19]}),s(o.PrimaryButton,{class:y(["ms-3",{"opacity-25":o.updateApiTokenForm.processing}]),disabled:o.updateApiTokenForm.processing,onClick:o.updateApiToken},{default:t(()=>e[20]||(e[20]=[i(" Save ")])),_:1,__:[20]},8,["class","disabled"])]),_:1},8,["show"]),s(o.ConfirmationModal,{show:o.apiTokenBeingDeleted!=null,onClose:e[8]||(e[8]=n=>o.apiTokenBeingDeleted=null)},{title:t(()=>e[21]||(e[21]=[i(" Delete API Token ")])),content:t(()=>e[22]||(e[22]=[i(" Are you sure you would like to delete this API token? ")])),footer:t(()=>[s(o.SecondaryButton,{onClick:e[7]||(e[7]=n=>o.apiTokenBeingDeleted=null)},{default:t(()=>e[23]||(e[23]=[i(" Cancel ")])),_:1,__:[23]}),s(o.DangerButton,{class:y(["ms-3",{"opacity-25":o.deleteApiTokenForm.processing}]),disabled:o.deleteApiTokenForm.processing,onClick:o.deleteApiToken},{default:t(()=>e[24]||(e[24]=[i(" Delete ")])),_:1,__:[24]},8,["class","disabled"])]),_:1},8,["show"])])}const xe=E(U,[["render",ne],["__file","ApiTokenManager.vue"]]);export{xe as default};
