import{c as J,o as n,w as g,a as l,b as o,f as d,t as u,n as b,l as K,d as m,e as v,F as T,r as O,E as Q,g as z,x as G,G as H,S as X}from"./app-uXddmEpz.js";import{f as M,i as W,b as j}from"./helper-BoB9zCoy.js";import{A as Y}from"./AppLayout-Br8Pf_X-.js";import{T as Z}from"./TextInput-CHlK30DQ.js";import{L as $}from"./LoadingButton-BLKfR7Zt.js";import{I as ee}from"./InputLabel-D_8-PT0K.js";import{I as te}from"./InputError-ttZ3AOSc.js";import{S as le}from"./SelectInput-7AHhNMzI.js";import{P as re,S as oe,D as ae}from"./PaymentSummaryCard-7Fm_be5d.js";import{D as se}from"./DatePick-bkgg8O9e.js";import{_ as ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Logo-C5gnPx-H.js";import"./Icons-C3pYYq2K.js";import"./Footer-Xx_KaGDa.js";import"./v4-C6aID195.js";const ie={__name:"Form",props:{volanteRental:Object,stallTypes:Object,requirements:Object,paymentDetails:Object},setup(P,{expose:t}){var w,k,h,I,S,V,q,D,E,L;t();const f=Q(),e=P,i=z(1),a=()=>W(f.url),B=[{id:1,name:"Daily "},{id:2,name:"Weekly "},{id:3,name:"Event-based"}],c=z([]),s=G({business_name:a()?(w=e==null?void 0:e.volanteRental)==null?void 0:w.name:"",location:a()?(k=e==null?void 0:e.volanteRental)==null?void 0:k.location:"",duration:a()?(h=e==null?void 0:e.volanteRental)==null?void 0:h.duration:[],started_date:a()?M((I=e==null?void 0:e.volanteRental)==null?void 0:I.start_date):"",end_date:a()?M((S=e==null?void 0:e.volanteRental)==null?void 0:S.end_date):"",stall_id:a()?(q=(V=e==null?void 0:e.volanteRental)==null?void 0:V.stalls)==null?void 0:q.id:"",quantity:a()?(D=e==null?void 0:e.volanteRental)==null?void 0:D.quantity:"",requirements:[],receipt:null,reference_number:a()?(L=(E=e==null?void 0:e.volanteRental)==null?void 0:E.paymentRecord)==null?void 0:L.reference_number:"",amount:0,step:i}),y=H(()=>{var r;return(r=e==null?void 0:e.stallTypes)==null?void 0:r.find(C=>C.id===Number(s.stall_id))}),x=()=>{var r,C,A;s.requirements=a()?(r=e==null?void 0:e.volanteRental)==null?void 0:r.requirements.map(R=>({requirement_checklist_id:R.checklist_id,attachment:R.attachment})):c.value.map(R=>({requirement_checklist_id:R.documentType,attachment:R.file})),s.amount=(C=e==null?void 0:e.paymentDetails)==null?void 0:C.total,s.location=(A=y==null?void 0:y.value)==null?void 0:A.location,s.post(route("applications.volantes.store"),{onSuccess:()=>{s.reset(),c.value=[]}})},_=()=>{var r;s.put(route("applications.volantes.update",(r=e==null?void 0:e.volanteRental)==null?void 0:r.id))},p={page:f,props:e,step:i,checkIfEdit:a,durationsOptions:B,localFiles:c,form:s,selectedStall:y,submit:x,update:_,nextButton:()=>{i.value===1?(console.log(a()),a()?i.value++:s.post(route("applications.volantes.store"),{preserveState:!0,onSuccess:()=>{i.value++}})):i.value===2&&(a()?i.value++:c.value.some(r=>r.status==="uploading")?s.errors.requirements="Please wait until all files are uploaded.":c.value.length===0?s.errors.requirements="The requirements are required.":i.value++),s.step=i.value},stores:()=>{if(i.value===3)return a()?_():x()},feeDetails:r=>r!=null&&r.is_monthly?`${j(r.amount)} per month`:r!=null&&r.is_daily?`${j(r.amount)} per day`:`${j(r.amount)}`,computed:H,ref:z,get Link(){return X},get usePage(){return Q},get useForm(){return G},get formatAmount(){return j},get formatDateShort(){return M},get isEditPage(){return W},AppLayout:Y,TextInput:Z,LoadingButton:$,InputLabel:ee,InputError:te,SelectInput:le,DocumentUpload:ae,DatePick:se,SingleFileUpload:oe,PaymentSummaryCard:re};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}},de={class:"mb-8 text-3xl font-bold"},me={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},ue={class:"max-w-3xl bg-white rounded-md shadow overflow-hidden"},fe={class:"flex items-center px-8 py-4 bg-primary/20 border-t bg-primary/20"},ce={class:"flex items-center justify-between mt-6"},ge={class:"flex flex-col items-center text-center w-1/3"},be={class:"flex flex-col items-center text-center w-1/3"},ye={class:"flex flex-col items-center text-center w-1/3"},ve={key:0,class:"p-6 space-y-6"},xe={class:"flex flex-col md:flex-row gap-4"},_e={class:"w-full"},pe={class:"w-full"},we=["value","disabled"],ke={key:0,class:"border p-4 rounded bg-gray-50"},he={class:"ml-4 list-disc"},Ie={class:"flex flex-col md:flex-row gap-4"},Se={class:"w-full md:w-full"},Ve={class:"w-full md:w-full"},qe=["value"],De={class:"mt-4 flex flex-col md:flex-row gap-4"},Ee={class:"w-full md:w-full"},Le={class:"w-full md:w-full"},Re={key:1,class:"p-6 space-y-6"},Be={key:2,class:"p-6 space-y-6"},Ce={class:"flex flex-col md:flex-row gap-4 mt-5"},je={class:"w-full"},Pe={class:"flex flex-col md:flex-row gap-4 mt-5"},Ue={class:"w-full"},Fe={class:"w-full"},Ne={class:"flex items-center px-8 py-4 bg-gray-50 border-t border-gray-100"},Te={class:"ml-auto flex gap-2"},Oe=["disable"];function ze(P,t,f,e,i,a){return n(),J(e.AppLayout,{title:"Volante"},{header:g(()=>t[10]||(t[10]=[l("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Volante",-1)])),default:g(()=>{var B,c,s,y,x,_,U,F,N,p,w,k,h,I,S,V,q,D,E,L;return[l("h1",de,[o(e.Link,{class:"text-primary hover:text-secondary",href:"/my-applications/volante-rental-permits"},{default:g(()=>t[11]||(t[11]=[d("Volante Rentals")])),_:1,__:[11]}),t[12]||(t[12]=l("span",{class:"text-secondary font-medium"},"/",-1)),d(" "+u(e.checkIfEdit()?`${(c=(B=e.props)==null?void 0:B.volanteRental)==null?void 0:c.name}`:"Create New"),1)]),l("div",me,[l("div",ue,[l("div",fe,[o(e.LoadingButton,{loading:e.form.processing,class:"bg-btn-gradient ml-auto",type:"submit",disabled:((s=P.stallRental)==null?void 0:s.status)!==1},{default:g(()=>t[13]||(t[13]=[d(" Renew ")])),_:1,__:[13]},8,["loading","disabled"])]),l("div",ce,[l("div",ge,[l("div",{class:b(["flex items-center justify-center w-12 h-12 rounded-full border-2",e.step===1?"bg-primary text-white border-primary":"border-gray-300 text-gray-400"])},t[14]||(t[14]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5.121 17.804A7.968 7.968 0 0112 15c1.933 0 3.683.69 5.121 1.804M15 11a3 3 0 11-6 0 3 3 0 016 0z"})],-1)]),2),l("span",{class:b(["mt-2 text-sm",e.step===1?"text-primary font-semibold":"text-gray-400"])},"Business Info",2)]),l("div",{class:b(["flex-1 border-t-2 mx-2",e.step>1?"border-primary":"border-gray-200"])},null,2),l("div",be,[l("div",{class:b(["flex items-center justify-center w-12 h-12 rounded-full border-2",e.step===2?"bg-primary text-white border-primary":"border-gray-300 text-gray-400"])},t[15]||(t[15]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 7h10M7 11h10M7 15h6M5 5v14h14V5H5z"})],-1)]),2),l("span",{class:b(["mt-2 text-sm",e.step===2?"text-primary font-semibold":"text-gray-400"])},"Requirements",2)]),l("div",{class:b(["flex-1 border-t-2 mx-2",e.step>2?"border-primary":"border-gray-200"])},null,2),l("div",ye,[l("div",{class:b(["flex items-center justify-center w-12 h-12 rounded-full border-2",e.step===3?"bg-primary text-white border-primary":"border-gray-300 text-gray-400"])},t[16]||(t[16]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 1.343-3 3h6c0-1.657-1.343-3-3-3zm9 3c0 4.418-4.03 8-9 8s-9-3.582-9-8V7h18v4z"})],-1)]),2),l("span",{class:b(["mt-2 text-sm",e.step===3?"text-primary font-semibold":"text-gray-400"])},"Payment",2)])]),l("form",{onSubmit:K(e.stores,["prevent"])},[e.step===1?(n(),m("div",ve,[l("div",xe,[l("div",_e,[o(e.InputLabel,{for:"Business Name",value:"Business Name"}),o(e.TextInput,{id:"business_name",modelValue:e.form.business_name,"onUpdate:modelValue":t[0]||(t[0]=r=>e.form.business_name=r),type:"text",class:"mt-1 block w-full",required:"",autofocus:"",autocomplete:"business_name"},null,8,["modelValue"]),o(e.InputError,{class:"mt-2",message:(x=(y=e.form)==null?void 0:y.errors)==null?void 0:x.business_name},null,8,["message"])]),l("div",pe,[o(e.InputLabel,{for:"stall_id",value:"Stall",class:"mb-1 block w-full"}),o(e.SelectInput,{modelValue:e.form.stall_id,"onUpdate:modelValue":t[1]||(t[1]=r=>e.form.stall_id=r),id:"stall_id",required:"",class:"w-full",autocomplete:"stall_id",disabled:e.checkIfEdit()},{default:g(()=>[(n(!0),m(T,null,O(f.stallTypes,r=>(n(),m("option",{key:r.id,value:r.id,disabled:r.status===1||r.status===3},u(r.status===1||r.status===3?`${r.name} (${r.categories.description}) - OCCUPIED`:`${r.name} (${r.categories.description})`),9,we))),128))]),_:1},8,["modelValue","disabled"]),o(e.InputError,{class:"mt-2",message:(U=(_=e.form)==null?void 0:_.errors)==null?void 0:U.stall_id},null,8,["message"])])]),e.selectedStall?(n(),m("div",ke,[t[22]||(t[22]=l("h2",{class:"text-lg font-bold mb-2 text-secondary"},"Transient Details",-1)),l("p",null,[t[17]||(t[17]=l("strong",null,"Name:",-1)),d(" "+u(e.selectedStall.name),1)]),l("p",null,[t[18]||(t[18]=l("strong",null,"Size:",-1)),d(" "+u(e.selectedStall.area_of_sqr_meter),1)]),l("p",null,[t[19]||(t[19]=l("strong",null,"Coordinates:",-1)),d(" "+u(`Longitude-${JSON.parse(e.selectedStall.size).long}, Latitude-${JSON.parse(e.selectedStall.size).lat}`),1)]),l("p",null,[t[20]||(t[20]=l("strong",null,"Category:",-1)),d(" "+u(e.selectedStall.categories.name),1)]),l("p",null,[t[21]||(t[21]=l("strong",null,"Description:",-1)),d(" "+u(e.selectedStall.categories.description),1)]),t[23]||(t[23]=l("h3",{class:"mt-2 font-semibold text-secondary"},"Fees:",-1)),l("ul",he,[(n(!0),m(T,null,O(e.selectedStall.categories.fee,r=>(n(),m("li",{key:r.id},[l("strong",null,u(r.type)+":",1),d(" "+u(e.feeDetails(r)),1)]))),128))])])):v("",!0),l("div",Ie,[l("div",Se,[o(e.InputLabel,{for:"Quantity",value:"Quantity(kilo or styro)"}),o(e.TextInput,{id:"quantity",modelValue:e.form.quantity,"onUpdate:modelValue":t[2]||(t[2]=r=>e.form.quantity=r),type:"number",class:"mt-1 block w-full",required:"",autofocus:"",autocomplete:"quantity"},null,8,["modelValue"]),o(e.InputError,{class:"mt-2",message:(N=(F=e.form)==null?void 0:F.errors)==null?void 0:N.quantity},null,8,["message"])]),l("div",Ve,[o(e.InputLabel,{for:"duration",value:"Duration",class:"mb-1 block w-full"}),o(e.SelectInput,{modelValue:e.form.duration,"onUpdate:modelValue":t[3]||(t[3]=r=>e.form.duration=r),id:"duration",required:"",class:"w-full",autocomplete:"duration"},{default:g(()=>[(n(),m(T,null,O(e.durationsOptions,r=>l("option",{key:r.id,value:r.id},u(r.name),9,qe)),64))]),_:1},8,["modelValue"]),o(e.InputError,{class:"mt-2",message:(w=(p=e.form)==null?void 0:p.errors)==null?void 0:w.duration},null,8,["message"])])]),l("div",De,[l("div",Ee,[o(e.InputLabel,{for:"started_date",value:"Start Date"}),o(e.DatePick,{id:"started_date",modelValue:e.form.started_date,"onUpdate:modelValue":t[4]||(t[4]=r=>e.form.started_date=r),class:"mt-1 block w-full",required:"",autofocus:"",autocomplete:"started_date"},null,8,["modelValue"]),o(e.InputError,{class:"mt-2",message:e.form.errors.started_date},null,8,["message"])]),l("div",Le,[o(e.InputLabel,{for:"end_date",value:"End Date"}),o(e.DatePick,{id:"end_date",modelValue:e.form.end_date,"onUpdate:modelValue":t[5]||(t[5]=r=>e.form.end_date=r),class:"mt-1 block w-full",required:"",autofocus:"",autocomplete:"end_date"},null,8,["modelValue"]),o(e.InputError,{class:"mt-2",message:e.form.errors.end_date},null,8,["message"])])])])):v("",!0),e.step===2?(n(),m("div",Re,[o(e.DocumentUpload,{requiredDocs:e.checkIfEdit()?(k=f.requirements)==null?void 0:k.volante_new:(h=f.requirements)==null?void 0:h.volante_renew,files:e.localFiles,"onUpdate:files":t[6]||(t[6]=r=>e.localFiles=r)},null,8,["requiredDocs","files"]),o(e.InputError,{class:"mt-2",message:e.form.errors.requirements},null,8,["message"])])):v("",!0),e.step===3?(n(),m("div",Be,[t[24]||(t[24]=l("h2",{class:"text-lg font-bold text-secondary mb-2"},"Payments",-1)),t[25]||(t[25]=l("p",{class:"text-gray-600"},"Please complete your payment below:",-1)),t[26]||(t[26]=l("iframe",{src:"https://www.lbp-eservices.com/egps/portal/Fields.jsp",class:"w-full h-96 border rounded-md"},null,-1)),l("div",Ce,[l("div",je,[o(e.PaymentSummaryCard,{details:e.step===3?f.paymentDetails:null},null,8,["details"])])]),l("div",Pe,[l("div",Ue,[o(e.InputLabel,{for:"reference_number",value:"Reference Number"}),o(e.TextInput,{id:"reference_number",modelValue:e.form.reference_number,"onUpdate:modelValue":t[7]||(t[7]=r=>e.form.reference_number=r),type:"text",class:"mt-1 block w-full",required:"",autofocus:"",autocomplete:"reference_number"},null,8,["modelValue"]),o(e.InputError,{class:"mt-2",message:(S=(I=e.form)==null?void 0:I.errors)==null?void 0:S.reference_number},null,8,["message"])]),l("div",Fe,[o(e.InputLabel,{for:"receipt",value:"Receipt",class:"mb-1 block w-full"}),o(e.SingleFileUpload,{modelValue:e.form.receipt,"onUpdate:modelValue":t[8]||(t[8]=r=>e.form.receipt=r),label:"Upload Official Receipt",accept:".jpg,.jpeg,.png,.pdf",class:"mt-1 block w-full",error:(q=(V=e.form)==null?void 0:V.errors)==null?void 0:q.receipt},null,8,["modelValue","error"]),o(e.InputError,{class:"mt-2",message:(E=(D=e.form)==null?void 0:D.errors)==null?void 0:E.receipt},null,8,["message"])])])])):v("",!0),l("div",Ne,[o(e.Link,{href:"/my-applications/volante-rental-permits",class:"text-red-600 hover:underline",tabindex:"-1"},{default:g(()=>t[27]||(t[27]=[d("Cancel")])),_:1,__:[27]}),l("div",Te,[e.step>1?(n(),m("button",{key:0,type:"button",class:"px-4 py-2 rounded-md bg-gray-200 hover:bg-gray-300",onClick:t[9]||(t[9]=r=>e.step--)}," Back ")):v("",!0),e.step<3?(n(),m("button",{key:1,type:"button",class:"px-4 py-2 rounded-md bg-primary text-white hover:bg-secondary",onClick:e.nextButton,disable:((L=f.volanteRental)==null?void 0:L.status)===1}," Next ",8,Oe)):v("",!0),e.step===3?(n(),J(e.LoadingButton,{key:2,loading:e.form.processing,class:"bg-primary ml-auto",type:"submit"},{default:g(()=>t[28]||(t[28]=[d(" Save ")])),_:1,__:[28]},8,["loading"])):v("",!0)])])],32)])])]}),_:1})}const rt=ne(ie,[["render",ze],["__file","Form.vue"]]);export{rt as default};
