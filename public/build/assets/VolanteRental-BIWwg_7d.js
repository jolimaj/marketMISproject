import{c as F,o as n,w as u,a as e,b as d,e as g,k as J,d as c,F as A,r as z,t as a,v as se,n as K,f as h,l as X,m as re,g as I,h as Y,x as Z,i as $,Q as ee}from"./app-BkL1CNwx.js";import{l as N,p as te}from"./pickBy-DBz4G69m.js";import{A as ae}from"./AppLayout-BPPdX9d-.js";import{B as oe}from"./BaseTable-COYnGHVO.js";import{P as le}from"./Pagination-DySzg0s6.js";import{S as ne}from"./SearchFilter-BYGHE1w8.js";import{B as ie}from"./Badge-km_yutmJ.js";import{f as de,a as ce,b as me,c as ue}from"./helper-Jpd2WSUx.js";import{I as xe}from"./Icons-DwfuqtxP.js";import{D as fe}from"./Drawer-Bd1JPLm3.js";import{C as pe}from"./ConfirmationModal-DaMdbgjb.js";import{S as ye}from"./SecondaryButton-CBHJF43I.js";import{D as ge}from"./DangerButton-LWdATqaO.js";import{I as he}from"./InputError-DDM46-4k.js";import{F as we}from"./FlashMessage-BQau8JjT.js";import{_ as _e}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Logo-DeUXyAzp.js";import"./Footer-DHOCUsg6.js";import"./Modal-CpcotBMD.js";const ve={__name:"VolanteRental",props:{stallsCategories:Object,volanteRentals:Object,filters:Object,user:Object},setup(w,{expose:s}){var V,R;s();const _=["Rental No.","Vendor","Business Name","Duration","Type","Monthly Payment","Due Date","Penalty","Current Payment","Status",""],t=I(!1),p=I({}),M=I(!1),P=[{id:1,name:"Daily "},{id:2,name:"Weekly "},{id:3,name:"Event-based"}],f=w,o=Y({search:(V=f==null?void 0:f.filters)==null?void 0:V.search,category:(R=f==null?void 0:f.filters)==null?void 0:R.category}),m=Z({remarks:""});$(o,N.throttle(()=>{ee.get("/admin/rental-management/market-volante",te(o),{preserveState:!0})},150),{deep:!0});function r(){o.search="",o.category=null,Object.assign(o,N.mapValues(o,()=>null))}function B(i){let x="";return i===1?x="Daily":i===2?x="Weekly":x="Event based",x}function v(i){p.value=i,t.value=!0}const y={headers:_,showDrawer:t,drawerData:p,isRejected:M,durationsOptions:P,props:f,forms:o,form:m,reset:r,duration:B,getDetails:v,status:i=>{console.log(i);let x={color:"blue",status:"Pending"};switch(i){case 3:x={color:"orange",status:"Expired"};break;case 2:x={color:"red",status:"Rejected"};break;case 1:x={color:"green",status:"Approved"};break}return x},closeRejection:()=>{M.value=!1},rejectPermits:()=>{M.value=!0},approveConfirm:()=>{var i;delete m.remarks,m.put(route("department.applications.volantes.approve",(i=p==null?void 0:p.value)==null?void 0:i.id)),t.value=!1},rejectConfirm:()=>{var i;delete m.remarks,m.put(route("department.applications.volantes.reject",(i=p==null?void 0:p.value)==null?void 0:i.id)),t.value=!1},watch:$,reactive:Y,ref:I,get useForm(){return Z},get router(){return ee},get throttle(){return N.throttle},get mapValues(){return N.mapValues},get pickBy(){return te},AppLayout:ae,BaseTable:oe,Pagination:le,SearchFilter:ne,Badge:ie,get formatAmount(){return ue},get formatDate(){return me},get formatDateShort(){return ce},get fullName(){return de},Icons:xe,Drawer:fe,ConfirmationModal:pe,SecondaryButton:ye,DangerButton:ge,InputError:he,FlashMessage:we};return Object.defineProperty(y,"__isScriptSetup",{enumerable:!1,value:!0}),y}},ke={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},De={class:"flex items-center justify-between mb-6"},je=["value"],be={class:"px-4 py-3 capitalize text-center"},Ce={class:"px-4 py-3 capitalize text-center"},Be={class:"px-4 py-3 capitalize text-center"},Ve={class:"px-4 py-3 capitalize text-center"},Re={class:"px-4 py-3 capitalize text-center"},Se={class:"px-4 py-3 capitalize text-center"},Ae={class:"px-4 py-3 capitalize text-center"},ze={class:"px-4 py-3 capitalize text-center"},Me={class:"px-4 py-3 capitalize text-center"},Pe={class:"px-4 py-3 capitalize text-center"},Ie={key:0,class:"w-px border-t"},Ne={key:0},Fe={class:"mt-6 flex justify-center"},Ee={key:0},qe={class:"ml-auto w-full max-w-xl bg-white shadow-lg h-full overflow-y-auto"},Le={class:"p-4 border rounded-xl mb-4 bg-gray-50 flex justify-between items-center"},Oe={class:"flex items-center space-x-3"},Te={class:"font-semibold text-primary"},Ue={class:"flex items-center text-xs text-gray-500 space-x-2"},Qe={key:0,class:"flex space-x-2"},We={class:"p-4 border rounded-xl mb-5"},Ge={class:"space-y-2 text-sm"},He={class:"flex items-center space-x-2"},Je={class:"text-gray-600"},Ke={class:"flex items-center space-x-2"},Xe={class:"text-gray-600"},Ye={class:"flex items-center space-x-2"},Ze={class:"text-gray-600"},$e={class:"flex items-center space-x-2"},et={class:"text-gray-600"},tt={class:"flex items-center space-x-2"},st={class:"text-gray-600"},rt={class:"p-4 border rounded-xl mb-5"},at={class:"space-y-2 text-sm"},ot={class:"flex items-center space-x-2"},lt={class:"text-gray-600"},nt={class:"flex items-center space-x-2"},it={class:"text-gray-600"},dt={class:"p-4 border rounded-xl mb-5"},ct={class:"space-y-2 text-sm"},mt={class:"flex items-center space-x-2"},ut={class:"text-gray-600 text-sm"},xt={class:"flex items-center px-2 py-1 text-blue-600 hover:text-blue-800 text-sm"},ft=["href"],pt={class:"p-4 border rounded-xl mb-5"},yt={class:"space-y-2 text-sm"},gt={class:"flex items-center space-x-2"},ht={class:"space-y-2"},wt={class:"flex items-center space-x-2"},_t={class:"text-secondary"},vt={class:"text-gray-600"},kt={class:"flex items-center space-x-2"},Dt={class:"text-gray-600"},jt={key:0,class:"p-4 border rounded-xl"},bt={class:"space-y-2 text-sm"},Ct={class:"flex items-center space-x-2"},Bt={class:"space-y-2"},Vt={class:"flex items-center space-x-2"},Rt={class:"text-secondary"},St={class:"text-gray-600"},At={class:"space-y-4 p-4"},zt={class:"flex justify-end space-x-3 p-4"};function Mt(w,s,_,t,p,M){return n(),F(t.AppLayout,{title:"Volante"},{header:u(()=>[...s[4]||(s[4]=[e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Volante ",-1)])]),default:u(()=>{var P,f;return[s[32]||(s[32]=e("h1",{class:"mb-8 text-3xl font-bold text-primary"},"Market Volante",-1)),e("div",ke,[w.$page.props.flash.success?(n(),F(t.FlashMessage,{key:0,message:w.$page.props.flash.success,type:"success"},null,8,["message"])):g("",!0),w.$page.props.flash.error?(n(),F(t.FlashMessage,{key:1,message:w.$page.props.flash.error,type:"error"},null,8,["message"])):g("",!0),e("div",De,[d(t.SearchFilter,{modelValue:t.forms.search,"onUpdate:modelValue":s[1]||(s[1]=o=>t.forms.search=o),class:"mr-4 w-full max-w-md",onReset:t.reset},{default:u(()=>[s[6]||(s[6]=e("label",{class:"block text-gray-700"},"Stall Category:",-1)),J(e("select",{"onUpdate:modelValue":s[0]||(s[0]=o=>t.forms.category=o),class:"form-select mt-1 w-full"},[s[5]||(s[5]=e("option",{value:null},"All",-1)),(n(!0),c(A,null,z(_.stallsCategories,o=>(n(),c("option",{key:o.id,value:o.id},a(o.name),9,je))),128))],512),[[se,t.forms.category]])]),_:1},8,["modelValue"])]),d(t.BaseTable,{headers:t.headers,data:(P=_.volanteRentals)==null?void 0:P.data,class:K("center")},{row:u(({data:o})=>{var m;return[(n(!0),c(A,null,z(o,(r,B)=>{var v,k,D,j,b,C;return n(),c("tr",{key:_.volanteRentals.id,class:"hover:bg-gray-50"},[e("td",be,a((v=r==null?void 0:r.permits)!=null&&v.permit_number?`${(k=r==null?void 0:r.permits)==null?void 0:k.permit_number}`:"-"),1),e("td",Ce,a(`${(D=r.vendor)==null?void 0:D.first_name} ${r.vendor.last_name}`),1),e("td",Be,a(r.name),1),e("td",Ve,a(r!=null&&r.start_date&&(r!=null&&r.end_date)?`${t.formatDate(r.start_date)} - ${t.formatDate(r.end_date)}`:"-"),1),e("td",Re,[d(t.Badge,{color:((j=r==null?void 0:r.permits)==null?void 0:j.type)==="new"?"green":"blue"},{default:u(()=>{var y;return[h(a((y=r==null?void 0:r.permits)==null?void 0:y.type),1)]}),_:2},1032,["color"])]),e("td",Se,a(t.formatAmount(r==null?void 0:r.quarterly_payment)),1),e("td",Ae,a(t.formatDate(new Date(r==null?void 0:r.next_payment_due))),1),e("td",ze,a(t.formatAmount(r==null?void 0:r.penalty)),1),e("td",Me,[e("p",{class:K(["font-semibold",(r==null?void 0:r.current_payment)==="Paid"?"text-green-600":"text-red-600"])},a(r==null?void 0:r.current_payment),3)]),e("td",Pe,[d(t.Badge,{color:t.status(r.permits.status).color},{default:u(()=>[h(a(t.status(r.permits.status).status),1)]),_:2},1032,["color"])]),((C=(b=t.props)==null?void 0:b.filters)==null?void 0:C.role)!=="user"?(n(),c("td",Ie,[d(t.Icons,{name:"cheveron-right",onClick:y=>t.getDetails(r),class:"block w-6 h-6 fill-primary"},null,8,["onClick"])])):g("",!0)])}),128)),((m=_.volanteRentals)==null?void 0:m.total)===0?(n(),c("tr",Ne,[...s[7]||(s[7]=[e("td",{class:"px-6 py-4 border-t text-center",colspan:"11"},"No records found.",-1)])])):g("",!0)]}),_:1},8,["data"])]),e("div",Fe,[d(t.Pagination,{links:(f=_.volanteRentals)==null?void 0:f.links},null,8,["links"])]),d(t.Drawer,{modelValue:t.showDrawer,"onUpdate:modelValue":s[2]||(s[2]=o=>t.showDrawer=o),title:"Application Details",data:t.drawerData.value},{default:u(()=>{var o,m,r,B,v,k,D,j,b,C,y,V,R,i,x,E,q,L,O,T,U,Q,W;return[t.drawerData?(n(),c("div",Ee,[e("div",qe,[e("div",Le,[e("div",Oe,[d(t.Icons,{name:"stalls",class:"block w-6 h-6 fill-primary"}),e("div",null,[e("p",Te,a(`Market Volante Rental Application (${(m=(o=t.drawerData)==null?void 0:o.permits)==null?void 0:m.type})`),1),e("div",Ue,[d(t.Badge,{color:t.status((r=t.drawerData)==null?void 0:r.permits.status).color},{default:u(()=>{var l;return[h(a(t.status((l=t.drawerData)==null?void 0:l.permits.status).status),1)]}),_:1},8,["color"]),e("span",null,a(`â€¢ Applied ${t.formatDateShort(t.drawerData.permits.created_at)}`),1)])])]),((B=w.$page.props.auth.user)==null?void 0:B.role_id)===2?(n(),c("div",Qe,[e("button",{class:"flex items-center px-3 py-1.5 text-white bg-red-600 rounded-lg hover:bg-red-700 text-sm",onClick:t.rejectPermits},[...s[8]||(s[8]=[e("svg",{class:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:`M4.293 4.293a1 1 0 
                            011.414 0L10 8.586l4.293-4.293a1 1 0 
                            111.414 1.414L11.414 10l4.293 4.293a1 1 
                            01-1.414 1.414L10 11.414l-4.293 4.293a1 
                            1 0 01-1.414-1.414L8.586 10 4.293 
                            5.707a1 1 0 010-1.414z`,"clip-rule":"evenodd"})],-1),h(" Reject ",-1)])]),e("form",{onSubmit:X(t.approveConfirm,["prevent"])},[...s[9]||(s[9]=[e("button",{class:"flex items-center px-3 py-1.5 text-white bg-green-600 rounded-lg hover:bg-green-700 text-sm"},[e("svg",{class:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:`M16.707 5.293a1 1 0 
                                010 1.414l-8 8a1 1 0 
                                01-1.414 0l-4-4a1 1 0 
                                011.414-1.414L8 12.586l7.293-7.293a1 1 
                                0 011.414 0z`,"clip-rule":"evenodd"})]),h(" Approve ")],-1)])],32)])):g("",!0)]),e("div",We,[s[20]||(s[20]=e("h3",{class:"text-md font-semibold mb-3 text-primary"},"Vendor Information",-1)),e("ul",Ge,[e("li",He,[s[11]||(s[11]=e("svg",{class:"w-4 h-4 text-secondary font-bold",fill:"none",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64",width:"64",height:"64",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round","aria-hidden":"true"},[e("circle",{cx:"32",cy:"20",r:"8"}),e("path",{d:"M16 52c0-8 8-14 16-14s16 6 16 14"})],-1)),e("span",null,[s[10]||(s[10]=e("strong",{class:"text-secondary"},"Full Name: ",-1)),e("span",Je,a(`${t.fullName((v=t.drawerData)==null?void 0:v.vendor)}`),1)])]),e("li",Ke,[s[13]||(s[13]=e("svg",{class:"w-4 h-4 text-secondary",fill:"none",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64",width:"64",height:"64",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round","aria-hidden":"true"},[e("rect",{x:"10",y:"16",width:"44",height:"32",rx:"4",ry:"4"}),e("polyline",{points:"10,16 32,36 54,16"})],-1)),e("span",null,[s[12]||(s[12]=e("strong",{class:"text-secondary"},"Email Address: ",-1)),e("span",Xe,a((D=(k=t.drawerData)==null?void 0:k.vendor)==null?void 0:D.email),1)])]),e("li",Ye,[s[15]||(s[15]=e("svg",{class:"w-4 h-4 text-secondary",fill:"none",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64",width:"64",height:"64",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round","aria-hidden":"true"},[e("rect",{x:"20",y:"8",width:"24",height:"48",rx:"4",ry:"4"}),e("circle",{cx:"32",cy:"50",r:"2"})],-1)),e("span",null,[s[14]||(s[14]=e("strong",{class:"text-secondary"},"Phone Number: ",-1)),e("span",Ze,a((b=(j=t.drawerData)==null?void 0:j.vendor)==null?void 0:b.mobile),1)])]),e("li",$e,[s[17]||(s[17]=e("svg",{class:"w-4 h-4 text-secondary",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64",width:"64",height:"64",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round","aria-hidden":"true"},[e("path",{d:"M32 8c-8 0-14 6-14 14 0 10 14 26 14 26s14-16 14-26c0-8-6-14-14-14z"}),e("circle",{cx:"32",cy:"22",r:"4"})],-1)),e("span",null,[s[16]||(s[16]=e("strong",{class:"text-secondary"},"Address: ",-1)),e("span",et,a((y=(C=t.drawerData)==null?void 0:C.vendor)==null?void 0:y.address),1)])]),e("li",tt,[s[19]||(s[19]=e("svg",{class:"w-4 h-4 text-secondary",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64",width:"64",height:"64",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round","aria-hidden":"true"},[e("rect",{x:"10",y:"14",width:"44",height:"40",rx:"4",ry:"4"}),e("line",{x1:"10",y1:"24",x2:"54",y2:"24"}),e("line",{x1:"22",y1:"8",x2:"22",y2:"20"}),e("line",{x1:"42",y1:"8",x2:"42",y2:"20"}),e("circle",{cx:"32",cy:"38",r:"4"})],-1)),e("span",null,[s[18]||(s[18]=e("strong",{class:"text-secondary"},"Birthday: ",-1)),e("span",st,a(t.formatDateShort((R=(V=t.drawerData)==null?void 0:V.vendor)==null?void 0:R.birthday)),1)])])])]),e("div",rt,[s[23]||(s[23]=e("h3",{class:"text-md font-semibold mb-3 text-primary"},"Business Information",-1)),e("ul",at,[e("li",ot,[d(t.Icons,{name:"business-names",class:"w-4 h-4 text-secondary"}),e("span",null,[s[21]||(s[21]=e("strong",{class:"text-secondary"},"Business Name: ",-1)),e("span",lt,a((i=t.drawerData)==null?void 0:i.name),1)])]),e("li",nt,[d(t.Icons,{name:"business-category",class:"w-4 h-4 text-secondary"}),e("span",null,[s[22]||(s[22]=e("strong",{class:"text-secondary"},"Category: ",-1)),e("span",it,a((q=(E=(x=t.drawerData)==null?void 0:x.stalls)==null?void 0:E.stallsCategories)==null?void 0:q.name),1)])])])]),e("div",dt,[s[24]||(s[24]=e("h3",{class:"text-sm font-semibold mb-3 text-primary"},"Requirements Submitted",-1)),e("ul",ct,[(n(!0),c(A,null,z(t.drawerData.requirements,(l,S)=>(n(),c("li",{key:S,class:"flex justify-between items-center bg-gray-50 px-3 py-2 rounded-lg shadow-sm"},[e("div",mt,[d(t.Icons,{name:"requirements",class:"block w-6 h-6 fill-primary"}),e("span",ut,a(l.name),1)]),e("button",xt,[l.url?(n(),c("a",{key:0,href:`${l.url}/${l.attachment}`,class:"text-blue-600 ml-2 hover:underline",target:"_blank"}," [View] ",8,ft)):g("",!0)])]))),128))])]),e("div",pt,[s[26]||(s[26]=e("h3",{class:"text-md font-semibold mb-3 text-primary"},"Payments",-1)),e("ul",yt,[e("li",gt,[e("ul",ht,[(n(!0),c(A,null,z((O=(L=t.drawerData)==null?void 0:L.paymentDetails)==null?void 0:O.breakdown,(l,S)=>(n(),c("li",{key:S,class:"flex justify-between items-center bg-gray-50 px-3 py-2 rounded-lg shadow-sm"},[e("div",wt,[e("span",null,[e("strong",_t,a(`â€¢ ${l==null?void 0:l.type}: `),1),e("span",vt,a(t.formatAmount(l==null?void 0:l.amount)),1)])])]))),128))])]),e("li",kt,[e("span",null,[s[25]||(s[25]=e("strong",{class:"text-secondary"},"Total: ",-1)),e("span",Dt,a(t.formatAmount((T=t.drawerData)==null?void 0:T.quarterly_payment)),1)])])])]),((Q=(U=t.drawerData)==null?void 0:U.approvals)==null?void 0:Q.length)>0?(n(),c("div",jt,[s[27]||(s[27]=e("h3",{class:"text-md font-semibold mb-3 text-primary"},"Approvals",-1)),e("ul",bt,[e("li",Ct,[e("ul",Bt,[(n(!0),c(A,null,z((W=t.drawerData)==null?void 0:W.approvals,(l,S)=>{var G,H;return n(),c("li",{key:S,class:"flex justify-between items-center bg-gray-50 px-3 py-2 rounded-lg shadow-sm"},[e("div",Vt,[e("span",null,[e("strong",Rt,a(`${l==null?void 0:l.department}: `),1),e("span",St,a(`${(G=l==null?void 0:l.approver)==null?void 0:G.name}(${(H=l==null?void 0:l.approver)==null?void 0:H.position})`),1)])])])}),128))])])])])):g("",!0)])])):g("",!0)]}),_:1},8,["modelValue","data"]),d(t.ConfirmationModal,{show:t.isRejected,onClose:t.closeRejection},{title:u(()=>[...s[28]||(s[28]=[h(" Reject Request ",-1)])]),content:u(()=>{var o,m;return[e("div",At,[s[29]||(s[29]=e("p",{class:"text-gray-700 text-sm md:text-base"}," Are you sure you would like to reject this request? Please provide a reason below: ",-1)),e("div",null,[J(e("textarea",{id:"remarks","onUpdate:modelValue":s[3]||(s[3]=r=>t.form.remarks=r),rows:"3",required:"",placeholder:"Enter your reason for rejection...",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500 sm:text-sm resize-none"},null,512),[[re,t.form.remarks]]),d(t.InputError,{class:"mt-2",message:(m=(o=t.form)==null?void 0:o.errors)==null?void 0:m.remarks},null,8,["message"])])])]}),footer:u(()=>[e("div",zt,[d(t.SecondaryButton,{onClick:t.closeRejection},{default:u(()=>[...s[30]||(s[30]=[h(" Cancel ",-1)])]),_:1}),e("form",{onSubmit:X(t.rejectConfirm,["prevent"])},[d(t.DangerButton,{disabled:!t.form.remarks,class:"disabled:opacity-50"},{default:u(()=>[...s[31]||(s[31]=[h(" Reject ",-1)])]),_:1},8,["disabled"])],32)])]),_:1},8,["show"])]}),_:1})}const $t=_e(ve,[["render",Mt],["__file","VolanteRental.vue"]]);export{$t as default};
