import{c as V,o as d,w as i,a as l,b as r,e as D,k as T,d as v,F as P,r as B,t as n,v as U,n as I,f as k,l as E,g as R,h as z,x as L,i as C,Q as F,S as M}from"./app-BkL1CNwx.js";import{l as j,p as A}from"./pickBy-DBz4G69m.js";import{A as O}from"./AppLayout-BPPdX9d-.js";import{B as q}from"./BaseTable-COYnGHVO.js";import{P as Q}from"./Pagination-DySzg0s6.js";import{I as G}from"./Icons-DwfuqtxP.js";import{f as H,b as J,c as K}from"./helper-Jpd2WSUx.js";import{B as W}from"./Badge-km_yutmJ.js";import{F as X}from"./FlashMessage-BQau8JjT.js";import{S as Y}from"./SearchFilter-BYGHE1w8.js";import{C as Z}from"./ConfirmationModal-DaMdbgjb.js";import{S as b}from"./SecondaryButton-CBHJF43I.js";import{I as $}from"./InputLabel-C9urSnAe.js";import{T as ee}from"./TextInput-duXXTKs6.js";import{I as te}from"./InputError-DDM46-4k.js";import{S as ae}from"./SingleFileUpload-Bwb2u20k.js";import{L as le}from"./LoadingButton-BKJNCDXS.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Logo-DeUXyAzp.js";import"./Footer-DHOCUsg6.js";import"./Modal-CpcotBMD.js";const oe={__name:"StallRental",props:{stallRentals:Object,filters:Object},setup(h,{expose:a}){var g,x;a();const m=R(!1),e=["Rental No.","Vendor","Business Name","Stall","Duration","Type","Quarterly Payment","Due Date","Penalty","Current Payment","Status",""],u=h,f=z({search:(g=u==null?void 0:u.filters)==null?void 0:g.search,type:(x=u==null?void 0:u.filters)==null?void 0:x.type}),p=L({receipt:null,reference_number:"",amount:0,stall_rental_id:null});C(f,j.throttle(()=>{F.get("/my-rentals/stall-leasing",A(f),{preserveState:!0})},150),{deep:!0});const N=o=>{let c={color:"blue",status:"Vacant"};switch(o){case 3:c={color:"orange",status:"Expired"};break;case 2:c={color:"red",status:"Rejected"};break;case 1:c={color:"green",status:"Approved"};break;default:c={color:"blue",status:"Pending"}}return c},s=[{id:1,name:"New"},{id:2,name:"Renewal"}];function _(){f.search="",f.type=null,Object.assign(f,mapValues(f,()=>null))}function t(){m.value=!1}function S(o){p.amount=o==null?void 0:o.quarterly_payment,p.stall_rental_id=Number(o==null?void 0:o.id),m.value=!0}const y={isPayment:m,headers:e,props:u,form:f,formData:p,status:N,statusOptions:s,reset:_,cancelPayment:t,payNow:S,submit:()=>{p.post(route("applications.payment"),{onSuccess:()=>{p.reset(),m.value=!1}})},watch:C,reactive:z,ref:R,get Link(){return M},get router(){return F},get useForm(){return L},get throttle(){return j.throttle},get pickBy(){return A},AppLayout:O,BaseTable:q,Pagination:Q,Icon:G,get formatAmount(){return K},get formatDate(){return J},get fullName(){return H},Badge:W,FlashMessage:X,SearchFilter:Y,ConfirmationModal:Z,SecondaryButton:b,InputLabel:$,TextInput:ee,InputError:te,SingleFileUpload:ae,LoadingButton:le};return Object.defineProperty(y,"__isScriptSetup",{enumerable:!1,value:!0}),y}},se={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},ie={class:"flex items-center justify-between mb-6"},ne=["value"],me={class:"px-4 py-3 capitalize text-center"},ce={class:"px-4 py-3 capitalize text-center"},de={class:"px-4 py-3 capitalize text-center"},ue={class:"px-4 py-3 capitalize text-center"},fe={class:"px-4 py-3 capitalize text-center"},pe={class:"px-4 py-3 capitalize text-center"},ye={class:"px-4 py-3 capitalize text-center"},ge={class:"px-4 py-3 capitalize text-center"},xe={class:"px-4 py-3 capitalize text-center"},_e={class:"px-4 py-3 capitalize text-center"},he={key:0,class:"font-semibold text-blue-600"},we=["disabled","onClick"],ve={class:"px-4 py-3 capitalize text-center"},ke={class:"px-4 py-3 capitalize"},Se={key:0},De={class:"mt-6 flex justify-center"},Ne={class:"space-y-4 p-4 text-left"},Ve={class:"flex flex-col md:flex-row gap-4 mt-5"},Pe={class:"w-full"},Be={class:"flex flex-col md:flex-row gap-4 mt-5"},Ie={class:"w-full"},Re={class:"w-full"},ze={class:"flex justify-end space-x-3 p-4"};function Le(h,a,m,e,u,f){return d(),V(e.AppLayout,{title:"Stalls"},{header:i(()=>[...a[5]||(a[5]=[l("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Stall ",-1)])]),default:i(()=>{var p,N;return[a[16]||(a[16]=l("h1",{class:"mb-8 text-3xl font-bold text-primary"},"Stalls Leasing",-1)),l("div",se,[h.$page.props.flash.success?(d(),V(e.FlashMessage,{key:0,message:h.$page.props.flash.success,type:"success"},null,8,["message"])):D("",!0),h.$page.props.flash.error?(d(),V(e.FlashMessage,{key:1,message:h.$page.props.flash.error,type:"error"},null,8,["message"])):D("",!0),l("div",ie,[r(e.SearchFilter,{modelValue:e.form.search,"onUpdate:modelValue":a[1]||(a[1]=s=>e.form.search=s),class:"mr-4 w-full max-w-md",onReset:e.reset},{default:i(()=>[a[7]||(a[7]=l("label",{class:"block text-gray-700"},"Type:",-1)),T(l("select",{"onUpdate:modelValue":a[0]||(a[0]=s=>e.form.type=s),class:"form-select mt-1 w-full"},[a[6]||(a[6]=l("option",{value:null},"All",-1)),(d(),v(P,null,B(e.statusOptions,s=>l("option",{key:s.id,value:s.id},n(s.name),9,ne)),64))],512),[[U,e.form.type]])]),_:1},8,["modelValue"]),r(e.Link,{type:"submit",class:I([{"opacity-25":e.form.processing},"bg-btn-gradient text-white font-bold uppercase px-5 py-2 rounded focus:outline-none shadow hover:bg-primary-700 transition-colors"]),disabled:e.form.processing,href:"/my-rentals/stall-leasing/create"},{default:i(()=>[...a[8]||(a[8]=[k("Rent New",-1)])]),_:1},8,["class","disabled"])]),r(e.BaseTable,{headers:e.headers,data:(p=m.stallRentals)==null?void 0:p.data,class:I("center text-center sticky right-0 bg-white z-10")},{row:i(({data:s})=>{var _;return[(d(!0),v(P,null,B(s,(t,S)=>{var w,y,g,x,o;return d(),v("tr",{key:m.stallRentals.id,class:"hover:bg-gray-50"},[l("td",me,n((w=t==null?void 0:t.permits)!=null&&w.permit_number?`${(y=t==null?void 0:t.permits)==null?void 0:y.permit_number}`:"-"),1),l("td",ce,n(`${e.fullName(t==null?void 0:t.vendor)}`),1),l("td",de,n(t.name),1),l("td",ue,n((g=t==null?void 0:t.stalls)==null?void 0:g.name),1),l("td",fe,n(t!=null&&t.start_date&&(t!=null&&t.end_date)?`${e.formatDate(t.start_date)} - ${e.formatDate(t.end_date)}`:"-"),1),l("td",pe,[r(e.Badge,{color:((x=t==null?void 0:t.permits)==null?void 0:x.type)==="new"?"green":"blue"},{default:i(()=>{var c;return[k(n((c=t==null?void 0:t.permits)==null?void 0:c.type),1)]}),_:2},1032,["color"])]),l("td",ye,n(e.formatAmount(t==null?void 0:t.quarterly_payment)),1),l("td",ge,n(t!=null&&t.next_payment_due?e.formatDate(new Date(t==null?void 0:t.next_payment_due)):"N/A"),1),l("td",xe,n(e.formatAmount(t==null?void 0:t.penalty)),1),l("td",_e,[(t==null?void 0:t.current_payment)==="Paid"?(d(),v("p",he,"Paid")):D("",!0),(t==null?void 0:t.current_payment)==="Not Paid"?(d(),v("button",{key:1,disabled:((o=t==null?void 0:t.permits)==null?void 0:o.status)!==1,class:"inline-block bg-blue-600 text-white font-bold uppercase px-5 py-2 rounded focus:outline-none shadow hover:bg-primary-700 transition-colors",onClick:c=>e.payNow(t),tabindex:"-1"}," Pay Now ",8,we)):D("",!0)]),l("td",ve,[r(e.Badge,{color:e.status(t.permits.status).color},{default:i(()=>[k(n(e.status(t.permits.status).status),1)]),_:2},1032,["color"])]),l("td",ke,[r(e.Link,{class:"flex items-center pr-2",href:`/my-rentals/stall-leasing/${t.id}`,tabindex:"-1"},{default:i(()=>[r(e.Icon,{name:"cheveron-right",class:"block w-6 h-6 fill-primary"})]),_:1},8,["href"])])])}),128)),((_=m.stallRentals)==null?void 0:_.total)===0?(d(),v("tr",Se,[...a[9]||(a[9]=[l("td",{class:"px-6 py-4 border-t text-center",colspan:"7"},"No records found.",-1)])])):D("",!0)]}),_:1},8,["data"])]),l("div",De,[r(e.Pagination,{links:(N=m.stallRentals)==null?void 0:N.links},null,8,["links"])]),r(e.ConfirmationModal,{show:e.isPayment,onClose:e.cancelPayment},{title:i(()=>[...a[10]||(a[10]=[k(" Pay Now ",-1)])]),content:i(()=>{var s,_,t,S,w,y,g,x;return[l("div",Ne,[a[11]||(a[11]=l("p",{class:"text-gray-600"},"Please complete your payment below:",-1)),a[12]||(a[12]=l("iframe",{src:"https://www.lbp-eservices.com/egps/portal/Fields.jsp",class:"w-full h-96 border rounded-md"},null,-1)),l("div",Ve,[l("div",Pe,[r(e.InputLabel,{for:"receipt",value:"Receipt",class:"mb-1 block w-full"}),r(e.SingleFileUpload,{modelValue:e.formData.receipt,"onUpdate:modelValue":a[2]||(a[2]=o=>e.formData.receipt=o),label:"Upload Official Receipt",accept:".jpg,.jpeg,.png,.pdf",class:"mt-1 block w-full",error:(_=(s=e.formData)==null?void 0:s.errors)==null?void 0:_.receipt},null,8,["modelValue","error"]),r(e.InputError,{class:"mt-2",message:(S=(t=e.formData)==null?void 0:t.errors)==null?void 0:S.receipt},null,8,["message"])])]),l("div",Be,[l("div",Ie,[r(e.InputLabel,{for:"amount",value:"Amount"}),r(e.TextInput,{id:"amount",modelValue:e.formData.amount,"onUpdate:modelValue":a[3]||(a[3]=o=>e.formData.amount=o),type:"text",class:"mt-1 block w-full",required:"",autofocus:"",autocomplete:"amount"},null,8,["modelValue"]),r(e.InputError,{class:"mt-2",message:(y=(w=e.formData)==null?void 0:w.errors)==null?void 0:y.amount},null,8,["message"])]),l("div",Re,[r(e.InputLabel,{for:"reference_number",value:"Reference Number"}),r(e.TextInput,{id:"reference_number",modelValue:e.formData.reference_number,"onUpdate:modelValue":a[4]||(a[4]=o=>e.formData.reference_number=o),type:"text",class:"mt-1 block w-full",required:"",autofocus:"",autocomplete:"reference_number"},null,8,["modelValue"]),r(e.InputError,{class:"mt-2",message:(x=(g=e.formData)==null?void 0:g.errors)==null?void 0:x.reference_number},null,8,["message"])])])])]}),footer:i(()=>[l("div",ze,[r(e.SecondaryButton,{onClick:e.cancelPayment},{default:i(()=>[...a[13]||(a[13]=[k(" Cancel ",-1)])]),_:1}),l("form",{onSubmit:E(e.submit,["prevent"])},[r(e.LoadingButton,{loading:e.form.processing,class:"bg-primary ml-auto",type:"submit"},{default:i(()=>[...a[14]||(a[14]=[k(" Submit ",-1)])]),_:1},8,["loading"])],32)])]),default:i(()=>[a[15]||(a[15]=l("div",null,null,-1))]),_:1},8,["show"])]}),_:1})}const et=re(oe,[["render",Le],["__file","StallRental.vue"]]);export{et as default};
