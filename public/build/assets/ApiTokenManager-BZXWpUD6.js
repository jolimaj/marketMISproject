import{d as a,o as l,b as s,e as u,w as t,f as i,n as y,a as r,F as b,r as P,t as k,u as A,g as T}from"./app-C9RkxTMI.js";import{A as x}from"./ActionMessage-4tsqtGqU.js";import{D as C,A as S}from"./DialogModal-fjORLAWT.js";import{C as B}from"./Checkbox-DBqeHnlx.js";import{C as D}from"./ConfirmationModal-mxzxap64.js";import{D as I}from"./DangerButton-CCvL6Bwb.js";import{F as _}from"./FormSection-v2dBdUfV.js";import{I as w}from"./InputError-Cu5q8nQX.js";import{I as M}from"./InputLabel-D-J_fIdO.js";import{P as V}from"./PrimaryButton-Dr2AwrD9.js";import{S as L}from"./SecondaryButton-CwTMIRNe.js";import{S as N}from"./SectionBorder-CwW-cUVG.js";import{T as j}from"./TextInput-BsID4eDm.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./SectionTitle-DXK-apa6.js";import"./Modal-bmjLihdU.js";const U={__name:"ApiTokenManager",props:{tokens:Array,availablePermissions:Array,defaultPermissions:Array},setup(p,{expose:e}){e();const d=p,o=A({name:"",permissions:d.defaultPermissions}),c=A({permissions:[]}),v=A({}),n=T(!1),m=T(null),g=T(null),F={props:d,createApiTokenForm:o,updateApiTokenForm:c,deleteApiTokenForm:v,displayingToken:n,managingPermissionsFor:m,apiTokenBeingDeleted:g,createApiToken:()=>{o.post(route("api-tokens.store"),{preserveScroll:!0,onSuccess:()=>{n.value=!0,o.reset()}})},manageApiTokenPermissions:f=>{c.permissions=f.abilities,m.value=f},updateApiToken:()=>{c.put(route("api-tokens.update",m.value),{preserveScroll:!0,preserveState:!0,onSuccess:()=>m.value=null})},confirmApiTokenDeletion:f=>{g.value=f},deleteApiToken:()=>{v.delete(route("api-tokens.destroy",g.value),{preserveScroll:!0,preserveState:!0,onSuccess:()=>g.value=null})},ref:T,get useForm(){return A},ActionMessage:x,ActionSection:S,Checkbox:B,ConfirmationModal:D,DangerButton:I,DialogModal:C,FormSection:_,InputError:w,InputLabel:M,PrimaryButton:V,SecondaryButton:L,SectionBorder:N,TextInput:j};return Object.defineProperty(F,"__isScriptSetup",{enumerable:!1,value:!0}),F}},z={class:"col-span-6 sm:col-span-4"},O={key:0,class:"col-span-6"},Y={class:"mt-2 grid grid-cols-1 md:grid-cols-2 gap-4"},q={class:"flex items-center"},G={class:"ms-2 text-sm text-gray-600"},H={key:0},J={class:"mt-10 sm:mt-0"},K={class:"space-y-6"},Q={class:"break-all"},R={class:"flex items-center ms-2"},W={key:0,class:"text-sm text-gray-400"},X=["onClick"],Z=["onClick"],h={key:0,class:"mt-4 bg-gray-100 px-4 py-2 rounded font-mono text-sm text-gray-500 break-all"},$={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ee={class:"flex items-center"},oe={class:"ms-2 text-sm text-gray-600"};function ne(p,e,d,o,c,v){return l(),a("div",null,[s(o.FormSection,{onSubmitted:o.createApiToken},{title:t(()=>[...e[9]||(e[9]=[i(" Create API Token ",-1)])]),description:t(()=>[...e[10]||(e[10]=[i(" API tokens allow third-party services to authenticate with our application on your behalf. ",-1)])]),form:t(()=>[r("div",z,[s(o.InputLabel,{for:"name",value:"Name"}),s(o.TextInput,{id:"name",modelValue:o.createApiTokenForm.name,"onUpdate:modelValue":e[0]||(e[0]=n=>o.createApiTokenForm.name=n),type:"text",class:"mt-1 block w-full",autofocus:""},null,8,["modelValue"]),s(o.InputError,{message:o.createApiTokenForm.errors.name,class:"mt-2"},null,8,["message"])]),d.availablePermissions.length>0?(l(),a("div",O,[s(o.InputLabel,{for:"permissions",value:"Permissions"}),r("div",Y,[(l(!0),a(b,null,P(d.availablePermissions,n=>(l(),a("div",{key:n},[r("label",q,[s(o.Checkbox,{checked:o.createApiTokenForm.permissions,"onUpdate:checked":e[1]||(e[1]=m=>o.createApiTokenForm.permissions=m),value:n},null,8,["checked","value"]),r("span",G,k(n),1)])]))),128))])])):u("",!0)]),actions:t(()=>[s(o.ActionMessage,{on:o.createApiTokenForm.recentlySuccessful,class:"me-3"},{default:t(()=>[...e[11]||(e[11]=[i(" Created. ",-1)])]),_:1},8,["on"]),s(o.PrimaryButton,{class:y({"opacity-25":o.createApiTokenForm.processing}),disabled:o.createApiTokenForm.processing},{default:t(()=>[...e[12]||(e[12]=[i(" Create ",-1)])]),_:1},8,["class","disabled"])]),_:1}),d.tokens.length>0?(l(),a("div",H,[s(o.SectionBorder),r("div",J,[s(o.ActionSection,null,{title:t(()=>[...e[13]||(e[13]=[i(" Manage API Tokens ",-1)])]),description:t(()=>[...e[14]||(e[14]=[i(" You may delete any of your existing tokens if they are no longer needed. ",-1)])]),content:t(()=>[r("div",K,[(l(!0),a(b,null,P(d.tokens,n=>(l(),a("div",{key:n.id,class:"flex items-center justify-between"},[r("div",Q,k(n.name),1),r("div",R,[n.last_used_ago?(l(),a("div",W," Last used "+k(n.last_used_ago),1)):u("",!0),d.availablePermissions.length>0?(l(),a("button",{key:1,class:"cursor-pointer ms-6 text-sm text-gray-400 underline",onClick:m=>o.manageApiTokenPermissions(n)}," Permissions ",8,X)):u("",!0),r("button",{class:"cursor-pointer ms-6 text-sm text-red-500",onClick:m=>o.confirmApiTokenDeletion(n)}," Delete ",8,Z)])]))),128))])]),_:1})])])):u("",!0),s(o.DialogModal,{show:o.displayingToken,onClose:e[3]||(e[3]=n=>o.displayingToken=!1)},{title:t(()=>[...e[15]||(e[15]=[i(" API Token ",-1)])]),content:t(()=>[e[16]||(e[16]=r("div",null," Please copy your new API token. For your security, it won't be shown again. ",-1)),p.$page.props.jetstream.flash.token?(l(),a("div",h,k(p.$page.props.jetstream.flash.token),1)):u("",!0)]),footer:t(()=>[s(o.SecondaryButton,{onClick:e[2]||(e[2]=n=>o.displayingToken=!1)},{default:t(()=>[...e[17]||(e[17]=[i(" Close ",-1)])]),_:1})]),_:1},8,["show"]),s(o.DialogModal,{show:o.managingPermissionsFor!=null,onClose:e[6]||(e[6]=n=>o.managingPermissionsFor=null)},{title:t(()=>[...e[18]||(e[18]=[i(" API Token Permissions ",-1)])]),content:t(()=>[r("div",$,[(l(!0),a(b,null,P(d.availablePermissions,n=>(l(),a("div",{key:n},[r("label",ee,[s(o.Checkbox,{checked:o.updateApiTokenForm.permissions,"onUpdate:checked":e[4]||(e[4]=m=>o.updateApiTokenForm.permissions=m),value:n},null,8,["checked","value"]),r("span",oe,k(n),1)])]))),128))])]),footer:t(()=>[s(o.SecondaryButton,{onClick:e[5]||(e[5]=n=>o.managingPermissionsFor=null)},{default:t(()=>[...e[19]||(e[19]=[i(" Cancel ",-1)])]),_:1}),s(o.PrimaryButton,{class:y(["ms-3",{"opacity-25":o.updateApiTokenForm.processing}]),disabled:o.updateApiTokenForm.processing,onClick:o.updateApiToken},{default:t(()=>[...e[20]||(e[20]=[i(" Save ",-1)])]),_:1},8,["class","disabled"])]),_:1},8,["show"]),s(o.ConfirmationModal,{show:o.apiTokenBeingDeleted!=null,onClose:e[8]||(e[8]=n=>o.apiTokenBeingDeleted=null)},{title:t(()=>[...e[21]||(e[21]=[i(" Delete API Token ",-1)])]),content:t(()=>[...e[22]||(e[22]=[i(" Are you sure you would like to delete this API token? ",-1)])]),footer:t(()=>[s(o.SecondaryButton,{onClick:e[7]||(e[7]=n=>o.apiTokenBeingDeleted=null)},{default:t(()=>[...e[23]||(e[23]=[i(" Cancel ",-1)])]),_:1}),s(o.DangerButton,{class:y(["ms-3",{"opacity-25":o.deleteApiTokenForm.processing}]),disabled:o.deleteApiTokenForm.processing,onClick:o.deleteApiToken},{default:t(()=>[...e[24]||(e[24]=[i(" Delete ",-1)])]),_:1},8,["class","disabled"])]),_:1},8,["show"])])}const xe=E(U,[["render",ne],["__file","ApiTokenManager.vue"]]);export{xe as default};
